


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Finding kernel parameters">
      
      
        <link rel="canonical" href="https://jejjohnson.github.io/hsic_alignment/notebooks/3_isotropic_scaling/3.0_scale_walk/">
      
      
        <meta name="author" content="J. Emmanuel Johnson">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.3">
    
    
      
        <title>3.0 scale walk - HSIC Alignment</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.62d34fff.min.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.c8acc6db.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=source+code+pro:300,400,400i,700%7Csource+code+pro&display=fallback">
        <style>body,input{font-family:"source code pro",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"source code pro",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../../css/pandas-dataframe.css">
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="gray">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#isotropic-scaling-experiment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://jejjohnson.github.io/hsic_alignment" title="HSIC Alignment" class="md-header-nav__button md-logo" aria-label="HSIC Alignment">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            HSIC Alignment
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              3.0 scale walk
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/jejjohnson/hsic_alignment/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jejjohnson/hsic_alignment
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://jejjohnson.github.io/hsic_alignment" title="HSIC Alignment" class="md-nav__button md-logo" aria-label="HSIC Alignment">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    HSIC Alignment
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/jejjohnson/hsic_alignment/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jejjohnson/hsic_alignment
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Notebooks
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Notebooks" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Notebooks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-1" type="checkbox" id="nav-2-1">
    
    <label class="md-nav__link" for="nav-2-1">
      1 1D parameter
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="1 1D parameter" data-md-level="2">
      <label class="md-nav__title" for="nav-2-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        1 1D parameter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../1_1D_parameter/1.0_motivation/" title="1.0 motivation" class="md-nav__link">
      1.0 motivation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../1_1D_parameter/2.0_preliminary_exp/" title="2.0 preliminary exp" class="md-nav__link">
      2.0 preliminary exp
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      2 gamma parameter
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="2 gamma parameter" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        2 gamma parameter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../2_gamma_parameter/1_explore_exp/" title="1 explore exp" class="md-nav__link">
      1 explore exp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2_gamma_parameter/2_visualize_1l/" title="2 visualize 1l" class="md-nav__link">
      2 visualize 1l
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2_gamma_parameter/2_visualize_20k/" title="2 visualize 20k" class="md-nav__link">
      2 visualize 20k
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../2_gamma_parameter/gamma_trial_experiment/" title="Gamma trial experiment" class="md-nav__link">
      Gamma trial experiment
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3" checked>
    
    <label class="md-nav__link" for="nav-2-3">
      3 isotropic scaling
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="3 isotropic scaling" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        3 isotropic scaling
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../0_preliminary_exp-Copy1/" title="0 preliminary exp Copy1" class="md-nav__link">
      0 preliminary exp Copy1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2.0_scale_viz/" title="2.0 scale viz" class="md-nav__link">
      2.0 scale viz
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        3.0 scale walk
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="3.0 scale walk" class="md-nav__link md-nav__link--active">
      3.0 scale walk
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#synopsis" class="md-nav__link">
    Synopsis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
    <nav class="md-nav" aria-label="Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#experimental-design" class="md-nav__link">
    Experimental Design
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo" class="md-nav__link">
    Demo
  </a>
  
    <nav class="md-nav" aria-label="Demo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    Helper Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-run-full-algorithm" class="md-nav__link">
    Test Run - Full Algorithm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-run-experimental-step" class="md-nav__link">
    Test Run - Experimental Step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-run-full-experiment-loop" class="md-nav__link">
    Test Run - Full Experiment Loop
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cases-walkthrough" class="md-nav__link">
    Cases - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Cases - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-i-unscaled-unnormalized" class="md-nav__link">
    Case I - Unscaled, Unnormalized
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-ii-unscaled-normalized" class="md-nav__link">
    Case II - Unscaled, Normalized
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-iii-scaled-unormalized" class="md-nav__link">
    Case III - Scaled, Unormalized
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-iv-scaled-normalized" class="md-nav__link">
    Case IV - Scaled, Normalized
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-3-4" type="checkbox" id="nav-2-3-4">
    
    <label class="md-nav__link" for="nav-2-3-4">
      Old
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Old" data-md-level="3">
      <label class="md-nav__title" for="nav-2-3-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Old
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../old/1.0_scale_walk/" title="1.0 scale walk" class="md-nav__link">
      1.0 scale walk
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4">
    
    <label class="md-nav__link" for="nav-2-4">
      4 distributions
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="4 distributions" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        4 distributions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/2.1_exp_gamma_space/" title="2.1 exp gamma space" class="md-nav__link">
      2.1 exp gamma space
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/2.2_exp_mutual_info/" title="2.2 exp mutual info" class="md-nav__link">
      2.2 exp mutual info
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/2.3_viz_mutual_info/" title="2.3 viz mutual info" class="md-nav__link">
      2.3 viz mutual info
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/untitled/" title="Untitled" class="md-nav__link">
      Untitled
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-4-5" type="checkbox" id="nav-2-4-5">
    
    <label class="md-nav__link" for="nav-2-4-5">
      Old
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Old" data-md-level="3">
      <label class="md-nav__title" for="nav-2-4-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Old
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/old/0_demo/" title="0 demo" class="md-nav__link">
      0 demo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/old/2.1_exp_walkthrough/" title="2.1 exp walkthrough" class="md-nav__link">
      2.1 exp walkthrough
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/old/3.1_trial_experiment/" title="3.1 trial experiment" class="md-nav__link">
      3.1 trial experiment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/old/3_exp_dimensions/" title="3 exp dimensions" class="md-nav__link">
      3 exp dimensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/old/4_visualize_dimensions/" title="4 visualize dimensions" class="md-nav__link">
      4 visualize dimensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../4_distributions/old/4_visualize_dimensions_original/" title="4 visualize dimensions original" class="md-nav__link">
      4 visualize dimensions original
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-5" type="checkbox" id="nav-2-5">
    
    <label class="md-nav__link" for="nav-2-5">
      Code reviews
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Code reviews" data-md-level="2">
      <label class="md-nav__title" for="nav-2-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Code reviews
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../code_reviews/1.0_estimate_sigma/" title="1.0 estimate sigma" class="md-nav__link">
      1.0 estimate sigma
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../code_reviews/2.0_estimate_hsic/" title="2.0 estimate hsic" class="md-nav__link">
      2.0 estimate hsic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../code_reviews/3.0_multivariate_dists/" title="3.0 multivariate dists" class="md-nav__link">
      3.0 multivariate dists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../code_reviews/4.1_params_gauss/" title="4.1 params gauss" class="md-nav__link">
      4.1 params gauss
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../code_reviews/4.2_params_tstudent/" title="4.2 params tstudent" class="md-nav__link">
      4.2 params tstudent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../code_reviews/5.0_fitting_mi/" title="5.0 fitting mi" class="md-nav__link">
      5.0 fitting mi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6">
    
    <label class="md-nav__link" for="nav-2-6">
      Demos
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Demos" data-md-level="2">
      <label class="md-nav__title" for="nav-2-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Demos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../demos/1_hsic-Copy1/" title="1 hsic Copy1" class="md-nav__link">
      1 hsic Copy1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../demos/2_estimate_sigma/" title="2 estimate sigma" class="md-nav__link">
      2 estimate sigma
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2-7" type="checkbox" id="nav-2-7">
    
    <label class="md-nav__link" for="nav-2-7">
      Ite toolbox
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Ite toolbox" data-md-level="2">
      <label class="md-nav__title" for="nav-2-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Ite toolbox
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../ite_toolbox/0_demo/" title="0 demo" class="md-nav__link">
      0 demo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ite_toolbox/1_fake_distributions/" title="1 fake distributions" class="md-nav__link">
      1 fake distributions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../ite_toolbox/Untitled/" title="Untitled" class="md-nav__link">
      Untitled
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#synopsis" class="md-nav__link">
    Synopsis
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    Code
  </a>
  
    <nav class="md-nav" aria-label="Code">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#experimental-design" class="md-nav__link">
    Experimental Design
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#demo" class="md-nav__link">
    Demo
  </a>
  
    <nav class="md-nav" aria-label="Demo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#helper-functions" class="md-nav__link">
    Helper Functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-run-full-algorithm" class="md-nav__link">
    Test Run - Full Algorithm
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-run-experimental-step" class="md-nav__link">
    Test Run - Experimental Step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-run-full-experiment-loop" class="md-nav__link">
    Test Run - Full Experiment Loop
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cases-walkthrough" class="md-nav__link">
    Cases - Walkthrough
  </a>
  
    <nav class="md-nav" aria-label="Cases - Walkthrough">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-i-unscaled-unnormalized" class="md-nav__link">
    Case I - Unscaled, Unnormalized
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-ii-unscaled-normalized" class="md-nav__link">
    Case II - Unscaled, Normalized
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-iii-scaled-unormalized" class="md-nav__link">
    Case III - Scaled, Unormalized
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-iv-scaled-normalized" class="md-nav__link">
    Case IV - Scaled, Normalized
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/jejjohnson/hsic_alignment/edit/master/docs/notebooks/3_isotropic_scaling/3.0_scale_walk.ipynb" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                
                
                <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h1 id="isotropic-scaling-experiment">Isotropic Scaling Experiment<a class="headerlink" href="#isotropic-scaling-experiment" title="Permanent link">&para;</a></h1>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h2 id="synopsis">Synopsis<a class="headerlink" href="#synopsis" title="Permanent link">&para;</a></h2>
<p>In this experiment, I will be looking at how the isotropic scaling effects the HSIC score for the HSIC and KA algorithms. In theory, because we are trying to find one parameter shared between the two kernel functions, there should be problems when the scale of one distribution is larger than another. It's a drawback of the method and it motivates the need to use two different parameters for the distributions.
</div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h2 id="code">Code<a class="headerlink" href="#code" title="Permanent link">&para;</a></h2>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="c1"># Insert path to model directory,.</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cwd</span><span class="si">}</span><span class="s2">/../../src&quot;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">tqdm</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">check_random_state</span>

<span class="c1"># toy datasets</span>
<span class="kn">from</span> <span class="nn">data.toy</span> <span class="kn">import</span> <span class="n">generate_dependence_data</span><span class="p">,</span> <span class="n">generate_isotropic_data</span>

<span class="c1"># Kernel Dependency measure</span>
<span class="kn">from</span> <span class="nn">models.train_models</span> <span class="kn">import</span> <span class="n">get_gamma_init</span>
<span class="kn">from</span> <span class="nn">models.train_models</span> <span class="kn">import</span> <span class="n">get_hsic</span>
<span class="kn">from</span> <span class="nn">models.kernel</span> <span class="kn">import</span> <span class="n">estimate_sigma</span><span class="p">,</span> <span class="n">sigma_to_gamma</span><span class="p">,</span> <span class="n">gamma_to_sigma</span><span class="p">,</span> <span class="n">get_param_grid</span>
<span class="kn">from</span> <span class="nn">models.ite_algorithms</span> <span class="kn">import</span> <span class="n">run_rbig_models</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="c1"># Plotting</span>
<span class="kn">from</span> <span class="nn">visualization.distribution</span> <span class="kn">import</span> <span class="n">plot_scorer</span>
<span class="kn">from</span> <span class="nn">visualization.scaling</span> <span class="kn">import</span> <span class="n">plot_scorer_scale</span><span class="p">,</span> <span class="n">plot_scorer_scale_norm</span>


<span class="c1"># experiment helpers</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="c1"># Plotting Procedures</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="c1"># plt.style.use([&#39;fivethirtyeight&#39;, &#39;seaborn-poster&#39;])</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># get rid of annoying warnings</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>


<span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span>
</code></pre></div>

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>[&#39;seaborn-dark-palette&#39;,
 &#39;classic&#39;,
 &#39;ggplot&#39;,
 &#39;seaborn-dark&#39;,
 &#39;seaborn-pastel&#39;,
 &#39;seaborn-bright&#39;,
 &#39;seaborn-deep&#39;,
 &#39;tableau-colorblind10&#39;,
 &#39;seaborn-talk&#39;,
 &#39;fast&#39;,
 &#39;seaborn-ticks&#39;,
 &#39;seaborn-white&#39;,
 &#39;bmh&#39;,
 &#39;fivethirtyeight&#39;,
 &#39;seaborn-muted&#39;,
 &#39;_classic_test&#39;,
 &#39;grayscale&#39;,
 &#39;seaborn-darkgrid&#39;,
 &#39;seaborn-poster&#39;,
 &#39;seaborn&#39;,
 &#39;seaborn-whitegrid&#39;,
 &#39;dark_background&#39;,
 &#39;seaborn-paper&#39;,
 &#39;seaborn-colorblind&#39;,
 &#39;seaborn-notebook&#39;,
 &#39;Solarize_Light2&#39;]</pre>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h3 id="experimental-design">Experimental Design<a class="headerlink" href="#experimental-design" title="Permanent link">&para;</a></h3>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
The objective of this experiment is to measure how the Mutual information (MI) changes related to the HSIC score of different methods when we change the data and preprocessing conditions (normalization and scale). We change the nature of the data via the scale of the data received and whether or not we do a normalization procedure before we submit the datasets to our HSIC algorithms. Each HSIC method will give us a score and we can calculate the Mutual information</p>
</div>
</div>
<p><strong>Free Params</strong></p>
<ul>
<li>Number of Trials (<code>seed</code>)<ul>
<li>1:10</li>
</ul>
</li>
<li>Scale or not scaled (<code>scale</code>)</li>
<li>Normalized | Not Normalized (<code>normalize</code>)</li>
<li>HSIC Algorithm (<code>method</code>)<ul>
<li>HSIC, KA, cKA</li>
</ul>
</li>
<li>Dataset (<code>dataset</code>)<ul>
<li>Linear, Sinusoidal, Circle, Random</li>
</ul>
</li>
<li>Amount of Noise (<code>noise</code> List)<ul>
<li>log space </li>
</ul>
</li>
</ul>
<p><strong>Measurements</strong></p>
<ul>
<li>Mutual Information (<code>mi</code>)</li>
<li>HSIC score (<code>score</code>)</li>
<li>Time for execution (<code>time</code>)</li>
</ul>
<p><strong>Fixed Parameters</strong></p>
<ul>
<li>Number of points (<code>num_points</code>)</li>
<li>Noise for X points (<code>noise_x</code>)</li>
<li>Noise for Y points (<code>noise_y</code>)</li>
<li></div>
</div></li>
</ul>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h2 id="demo">Demo<a class="headerlink" href="#demo" title="Permanent link">&para;</a></h2>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DataParams</span><span class="p">:</span>
    <span class="n">num_points</span> <span class="o">=</span> <span class="mi">1_000</span>
    <span class="n">noise_y</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="k">class</span> <span class="nc">ExpParams</span><span class="p">:</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="s1">&#39;sine&#39;</span><span class="p">,</span> <span class="s1">&#39;circ&#39;</span><span class="p">,</span> <span class="s1">&#39;rand&#39;</span><span class="p">]</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">normalized</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hsic&#39;</span><span class="p">,</span> <span class="s1">&#39;tka&#39;</span><span class="p">,</span> <span class="s1">&#39;ctka&#39;</span><span class="p">]</span>
    <span class="n">each_length</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="n">gamma_method</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
    <span class="p">]</span>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">digamma</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>

<span class="k">def</span> <span class="nf">compute_knn_mi</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Compute mutual information between two continuous variables.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x, y : ndarray, shape (n_samples,)</span>
<span class="sd">        Samples of two continuous random variables, must have an identical</span>
<span class="sd">        shape.</span>
<span class="sd">    n_neighbors : int</span>
<span class="sd">        Number of nearest neighbors to search for each point, see [1]_.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    mi : float</span>
<span class="sd">        Estimated mutual information. If it turned out to be negative it is</span>
<span class="sd">        replace by 0.</span>
<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    True mutual information can&#39;t be negative. If its estimate by a numerical</span>
<span class="sd">    method is negative, it means (providing the method is adequate) that the</span>
<span class="sd">    mutual information is close to 0 and replacing it by 0 is a reasonable</span>
<span class="sd">    strategy.</span>
<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [1] A. Kraskov, H. Stogbauer and P. Grassberger, &quot;Estimating mutual</span>
<span class="sd">           information&quot;. Phys. Rev. E 69, 2004.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

    <span class="c1"># Here we rely on NearestNeighbors to select the fastest algorithm.</span>
    <span class="n">nn</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s1">&#39;euclidean&#39;</span><span class="p">,</span> <span class="n">n_neighbors</span><span class="o">=</span><span class="n">n_neighbors</span><span class="p">)</span>

    <span class="n">nn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nextafter</span><span class="p">(</span><span class="n">radius</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Algorithm is selected explicitly to allow passing an array as radius</span>
    <span class="c1"># later (not all algorithms support this).</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">set_params</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;kd_tree&#39;</span><span class="p">)</span>

    <span class="n">nn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">radius_neighbors</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">return_distance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">])</span>

    <span class="n">nn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">radius_neighbors</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">return_distance</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">size</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">])</span>

    <span class="n">mi</span> <span class="o">=</span> <span class="p">(</span><span class="n">digamma</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span> <span class="o">+</span> <span class="n">digamma</span><span class="p">(</span><span class="n">n_neighbors</span><span class="p">)</span> <span class="o">-</span>
          <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">digamma</span><span class="p">(</span><span class="n">nx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">digamma</span><span class="p">(</span><span class="n">ny</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">mi</span><span class="p">)</span>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h4 id="helper-functions">Helper Functions<a class="headerlink" href="#helper-functions" title="Permanent link">&para;</a></h4>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Optional</span>

<span class="k">def</span> <span class="nf">get_gamma_name</span><span class="p">(</span><span class="n">gamma_method</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span><span class="nb">str</span><span class="p">,</span><span class="nb">str</span><span class="p">])</span><span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gamma_name</span> <span class="o">=</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gamma_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gamma_method</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_p</span><span class="si">{</span><span class="n">gamma_method</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gamma_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gamma_method</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_s</span><span class="si">{</span><span class="n">gamma_method</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">elif</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">gamma_method</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">gamma_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">gamma_method</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">_s</span><span class="si">{</span><span class="n">gamma_method</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">_s</span><span class="si">{</span><span class="n">gamma_method</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unrecognized Combination...&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">gamma_name</span>

<span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="c1"># plt.legend(fontsize=20)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">PROJECT_PATH</span> <span class="o">=</span> <span class="s2">&quot;/home/emmanuel/projects/2019_hsic_align/&quot;</span>
<span class="n">LOG_PATH</span> <span class="o">=</span> <span class="s2">&quot;src/experiments/logs/&quot;</span>
<span class="n">SAVE_PATH</span> <span class="o">=</span> <span class="s2">&quot;data/results/scaling/&quot;</span>
<span class="n">SAVE_NAME</span> <span class="o">=</span> <span class="s1">&#39;exp_scale_test.csv&#39;</span>


<span class="k">class</span> <span class="nc">ScaleExperiment</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_params</span><span class="p">,</span> <span class="n">exp_params</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_params</span> <span class="o">=</span> <span class="n">data_params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span> <span class="o">=</span> <span class="n">exp_params</span>

    <span class="k">def</span> <span class="nf">_get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">noise</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Gathers the raw dependence data&quot;&quot;&quot;</span>
        <span class="c1"># get dataset</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">generate_dependence_data</span><span class="p">(</span>
            <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span>
            <span class="n">num_points</span><span class="o">=</span><span class="mi">10_000</span><span class="p">,</span> <span class="c1">#self.data_params.num_points,</span>
            <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
            <span class="n">noise_x</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span>
            <span class="n">noise_y</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_params</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">beta</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_params</span><span class="o">.</span><span class="n">beta</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>

    <span class="k">def</span> <span class="nf">_apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">noise</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>

        <span class="n">rng</span> <span class="o">=</span> <span class="n">check_random_state</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

        <span class="n">X</span> <span class="o">+=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#         Y += rng.randn(Y.shape)</span>


        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>
    <span class="k">def</span> <span class="nf">_apply_scaling</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The scaling step in our experiment&quot;&quot;&quot;</span>
        <span class="c1"># apply scaling</span>
        <span class="k">return</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">X</span>

    <span class="k">def</span> <span class="nf">_apply_normalization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The normalization step in our experiment.&quot;&quot;&quot;</span>
        <span class="c1"># apply normalization</span>
        <span class="k">if</span> <span class="n">normalize</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">normalize</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unrecognized boolean value for normalize </span><span class="si">{</span><span class="n">normalize</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>

    <span class="k">def</span> <span class="nf">_apply_mi_estimate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Apply Mutual Information estimator. </span>
<span class="sd">        We choose to use RBIG as our estimator.&quot;&quot;&quot;</span>
        <span class="c1"># estimate mutual information</span>
<span class="c1">#         mi = compute_knn_mi(X, Y, 15)</span>
        <span class="n">mi</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">run_rbig_models</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">measure</span><span class="o">=</span><span class="s1">&#39;mi&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">mi</span>

    <span class="k">def</span> <span class="nf">_apply_hsic_estimate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> 
        <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
        <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
        <span class="n">gamma_init</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
        <span class="n">each_length</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Apply HSIC estimator using one of the 3 algorithms:</span>
<span class="sd">        * HSIC</span>
<span class="sd">        * KA</span>
<span class="sd">        * cKA</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># initialize the gamma parameter</span>
        <span class="k">if</span> <span class="n">each_length</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">gamma_init_X</span><span class="p">,</span> <span class="n">gamma_init_Y</span> <span class="o">=</span> <span class="n">get_gamma_init</span><span class="p">(</span>
                <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> 
                <span class="n">method</span><span class="o">=</span><span class="n">gamma_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                <span class="n">percent</span><span class="o">=</span><span class="n">gamma_init</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                <span class="n">scale</span><span class="o">=</span><span class="n">gamma_init</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                <span class="n">each_length</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># get hsic_value</span>
            <span class="n">hsic_value</span> <span class="o">=</span> <span class="n">get_hsic</span><span class="p">(</span>
                <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> 
                <span class="n">scorer</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> 
                <span class="n">gamma_init_X</span><span class="o">=</span><span class="n">gamma_init_X</span><span class="p">,</span> 
                <span class="n">gamma_init_Y</span><span class="o">=</span><span class="n">gamma_init_Y</span><span class="p">,</span>
                <span class="n">maximum</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">each_length</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">gamma_init</span> <span class="o">=</span> <span class="n">get_gamma_init</span><span class="p">(</span>                
                <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> 
                <span class="n">method</span><span class="o">=</span><span class="n">gamma_init</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> 
                <span class="n">percent</span><span class="o">=</span><span class="n">gamma_init</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                <span class="n">scale</span><span class="o">=</span><span class="n">gamma_init</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                <span class="n">each_length</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

            <span class="c1"># get hsic_value</span>
            <span class="n">hsic_value</span> <span class="o">=</span> <span class="n">get_hsic</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">gamma_init</span><span class="p">,</span> <span class="n">maximum</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">subsample</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data_params</span><span class="o">.</span><span class="n">num_points</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unrecognized selection for each_length: </span><span class="si">{</span><span class="n">each_length</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">hsic_value</span>

    <span class="k">def</span> <span class="nf">_experiment_step</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">results_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
        <span class="n">dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">noise</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">gamma_init</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
        <span class="n">each_length</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span><span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>

        <span class="c1"># Step I - Extract Data</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="c1">#         # Step I.1 - Apply Noise</span>
<span class="c1">#         X, Y = self._apply_noise(X=X, Y=Y, noise=noise, seed=seed)</span>

        <span class="c1"># Step II - Apply Scaling</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_scaling</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>

        <span class="c1"># Step III - Apply Normalization</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_normalization</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">)</span>

        <span class="c1"># Step IV - Estimate mutual information</span>
        <span class="n">mi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_mi_estimate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

        <span class="c1"># Step IV - Estimate HSIC value</span>
        <span class="n">hsic_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_apply_hsic_estimate</span><span class="p">(</span>
            <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> 
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> 
            <span class="n">gamma_init</span><span class="o">=</span><span class="n">gamma_init</span><span class="p">,</span> 
            <span class="n">each_length</span><span class="o">=</span><span class="n">each_length</span>
        <span class="p">)</span>

        <span class="c1"># Step V - Save Results to dataframe</span>
        <span class="n">results_df</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;normalized&#39;</span><span class="p">:</span> <span class="n">normalize</span><span class="p">,</span>
            <span class="s1">&#39;trial&#39;</span><span class="p">:</span> <span class="n">seed</span><span class="p">,</span>
            <span class="s1">&#39;dataset&#39;</span><span class="p">:</span> <span class="n">dataset</span><span class="p">,</span>
            <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="n">scale</span><span class="p">,</span>
            <span class="s1">&#39;scorer&#39;</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
            <span class="s1">&#39;gamma_method&#39;</span><span class="p">:</span> <span class="n">get_gamma_name</span><span class="p">(</span><span class="n">gamma_init</span><span class="p">),</span>
            <span class="s1">&#39;hsic_value&#39;</span><span class="p">:</span> <span class="n">hsic_value</span><span class="p">,</span>
            <span class="s2">&quot;mi&quot;</span><span class="p">:</span> <span class="n">mi</span><span class="p">,</span>
            <span class="s2">&quot;noise&quot;</span><span class="p">:</span> <span class="n">noise</span><span class="p">,</span>
            <span class="s2">&quot;each&quot;</span><span class="p">:</span> <span class="n">each_length</span><span class="p">,</span>
        <span class="p">},</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">results_df</span>

    <span class="k">def</span> <span class="nf">run_experiment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="c1">#         print(self.exp_params.seed)</span>

        <span class="c1"># Loop Through Free Parameters</span>
        <span class="k">for</span> <span class="n">iseed</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">seed</span><span class="p">:</span>
<span class="c1">#             print(iseed)</span>
            <span class="k">for</span> <span class="n">idataset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">dataset</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">inoise</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">noise</span><span class="p">:</span> 
                    <span class="k">for</span> <span class="n">iscale</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">scale</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">inormalize</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">normalized</span><span class="p">:</span>
                            <span class="k">for</span> <span class="n">ilength</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">each_length</span><span class="p">:</span>
                                <span class="k">for</span> <span class="n">igamma</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">gamma_method</span><span class="p">:</span>
                                    <span class="k">for</span> <span class="n">imethod</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_params</span><span class="o">.</span><span class="n">method</span><span class="p">:</span>
                                        <span class="n">results_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_experiment_step</span><span class="p">(</span>
                                            <span class="n">results_df</span><span class="o">=</span><span class="n">results_df</span><span class="p">,</span>
                                            <span class="n">dataset</span><span class="o">=</span><span class="n">idataset</span><span class="p">,</span>
                                            <span class="n">noise</span><span class="o">=</span><span class="n">inoise</span><span class="p">,</span> 
                                            <span class="n">seed</span><span class="o">=</span><span class="n">iseed</span><span class="p">,</span>
                                            <span class="n">scale</span><span class="o">=</span><span class="n">iscale</span><span class="p">,</span>
                                            <span class="n">normalize</span><span class="o">=</span><span class="n">inormalize</span><span class="p">,</span>
                                            <span class="n">method</span><span class="o">=</span><span class="n">imethod</span><span class="p">,</span>
                                            <span class="n">gamma_init</span><span class="o">=</span><span class="n">igamma</span><span class="p">,</span>
                                            <span class="n">each_length</span><span class="o">=</span><span class="n">ilength</span>
                                        <span class="p">)</span>
                                    <span class="n">results_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
                                        <span class="n">PROJECT_PATH</span>
                                        <span class="o">+</span> <span class="n">SAVE_PATH</span>
                                        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">SAVE_NAME</span><span class="si">}</span><span class="s2">&quot;</span>
                                    <span class="p">)</span>
        <span class="k">return</span> <span class="n">results_df</span>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h4 id="test-run-full-algorithm">Test Run - Full Algorithm<a class="headerlink" href="#test-run-full-algorithm" title="Permanent link">&para;</a></h4>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># Initialize Experiment class</span>
<span class="n">exp_class</span> <span class="o">=</span> <span class="n">ScaleExperiment</span><span class="p">(</span><span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span><span class="p">,</span> <span class="p">)</span>

<span class="c1"># ========================================</span>
<span class="c1"># Step I - Extract data</span>
<span class="c1"># ========================================</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="s1">&#39;sine&#39;</span>
<span class="n">noise</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">seed</span> <span class="o">=</span> <span class="mi">123</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">_get_data</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">)</span>

<span class="n">plot_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="c1"># ========================================</span>
<span class="c1"># Step IV - Estimate mutual information</span>
<span class="c1"># ========================================</span>
<span class="n">mi</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">_apply_mi_estimate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MI (RBIG): </span><span class="si">{</span><span class="n">mi</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># ========================================</span>
<span class="c1"># Step II - Apply Scaling</span>
<span class="c1"># ========================================</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mf">10.</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">_apply_scaling</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

<span class="c1"># ========================================</span>
<span class="c1"># Step III - Apply Normalization</span>
<span class="c1"># ========================================</span>
<span class="n">normalize</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">_apply_normalization</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">Y</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">)</span>

<span class="n">plot_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>



<span class="c1"># ========================================</span>
<span class="c1"># Step V - Estimate HSIC value</span>
<span class="c1"># ========================================</span>
<span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;hsic&#39;</span>
<span class="n">gamma_init</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="n">each_length</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">hsic_value</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">_apply_hsic_estimate</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> 
    <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> 
    <span class="n">gamma_init</span><span class="o">=</span><span class="n">gamma_init</span><span class="p">,</span> 
    <span class="n">each_length</span><span class="o">=</span><span class="n">each_length</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;HSIC score (</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s1">): </span><span class="si">{</span><span class="n">hsic_value</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div>

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h4 id="test-run-experimental-step">Test Run - Experimental Step<a class="headerlink" href="#test-run-experimental-step" title="Permanent link">&para;</a></h4>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

</div>
</div>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DataParams</span><span class="p">:</span>
    <span class="n">num_points</span> <span class="o">=</span> <span class="mi">5_000</span>
    <span class="n">noise_y</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="k">class</span> <span class="nc">ExpParams</span><span class="p">:</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;line&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;sine&#39;</span><span class="p">,</span> 
<span class="c1">#         &#39;circ&#39;,</span>
<span class="c1">#         &#39;rand&#39;</span>
    <span class="p">]</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#np.linspace(1,10,10)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">normalized</span> <span class="o">=</span> <span class="p">[</span>
        <span class="kc">True</span><span class="p">,</span> 
        <span class="kc">False</span>
    <span class="p">]</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;hsic&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;tka&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ctka&#39;</span>
    <span class="p">]</span>
    <span class="n">each_length</span> <span class="o">=</span> <span class="p">[</span>
<span class="c1">#         False, </span>
        <span class="kc">True</span>
    <span class="p">]</span>
    <span class="n">gamma_method</span> <span class="o">=</span> <span class="p">[</span>
<span class="c1">#         (&#39;median&#39;, 0.2, None),</span>
<span class="c1">#         (&#39;median&#39;, 0.4, None),</span>
        <span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="c1">#         (&#39;median&#39;, 0.6, None),</span>
<span class="c1">#         (&#39;median&#39;, 0.8, None),</span>
    <span class="p">]</span>
</code></pre></div>

</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># Initialize Experiment class</span>
<span class="n">exp_class</span> <span class="o">=</span> <span class="n">ScaleExperiment</span><span class="p">(</span><span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span><span class="p">,</span> <span class="p">)</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">_experiment_step</span><span class="p">(</span>
    <span class="n">results_df</span><span class="o">=</span><span class="n">results_df</span><span class="p">,</span>
    <span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="n">noise</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span>
    <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span>
    <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">,</span>
    <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
    <span class="n">gamma_init</span><span class="o">=</span><span class="n">gamma_init</span>
<span class="p">)</span>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">results_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div>

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>each</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>sine</td>
      <td>0.0</td>
      <td>median_p0.5</td>
      <td>0.091784</td>
      <td>3.355914</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h4 id="test-run-full-experiment-loop">Test Run - Full Experiment Loop<a class="headerlink" href="#test-run-full-experiment-loop" title="Permanent link">&para;</a></h4>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DataParams</span><span class="p">:</span>
    <span class="n">num_points</span> <span class="o">=</span> <span class="mi">1_000</span>
    <span class="n">noise_y</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="k">class</span> <span class="nc">ExpParams</span><span class="p">:</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;line&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;sine&#39;</span><span class="p">,</span> 
<span class="c1">#         &#39;circ&#39;,</span>
<span class="c1">#         &#39;rand&#39;</span>
    <span class="p">]</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#np.linspace(1,10,10)</span>
    <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">normalized</span> <span class="o">=</span> <span class="p">[</span>
        <span class="kc">True</span><span class="p">,</span> 
        <span class="kc">False</span>
    <span class="p">]</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">method</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;hsic&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;tka&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;ctka&#39;</span>
    <span class="p">]</span>
    <span class="n">each_length</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">]</span>
    <span class="n">gamma_method</span> <span class="o">=</span> <span class="p">[</span>
<span class="c1">#         (&#39;median&#39;, 0.2, None),</span>
<span class="c1">#         (&#39;median&#39;, 0.4, None),</span>
        <span class="p">(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="c1">#         (&#39;median&#39;, 0.6, None),</span>
<span class="c1">#         (&#39;median&#39;, 0.8, None),</span>
    <span class="p">]</span>

<span class="c1"># Initialize Experiment class</span>
<span class="n">exp_class</span> <span class="o">=</span> <span class="n">ScaleExperiment</span><span class="p">(</span><span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span><span class="p">,</span> <span class="p">)</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">run_experiment</span><span class="p">()</span>
</code></pre></div>

</div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">results_df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div>

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>each</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2395</th>
      <td>sine</td>
      <td>0.0</td>
      <td>median_p0.5</td>
      <td>0.194763</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2396</th>
      <td>sine</td>
      <td>0.0</td>
      <td>median_p0.5</td>
      <td>0.008053</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2397</th>
      <td>sine</td>
      <td>1.0</td>
      <td>median_p0.5</td>
      <td>0.000585</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2398</th>
      <td>sine</td>
      <td>1.0</td>
      <td>median_p0.5</td>
      <td>0.673256</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2399</th>
      <td>sine</td>
      <td>1.0</td>
      <td>median_p0.5</td>
      <td>0.006027</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered"></div>
</div>
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h2 id="cases-walkthrough">Cases - Walkthrough<a class="headerlink" href="#cases-walkthrough" title="Permanent link">&para;</a></h2>
<p></div>
</div></p>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_params</span><span class="p">(</span><span class="n">case</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>

    <span class="c1"># Case I - Unscaled, Unnormalized</span>
    <span class="k">if</span> <span class="n">case</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

        <span class="k">class</span> <span class="nc">DataParams</span><span class="p">:</span>
            <span class="n">num_points</span> <span class="o">=</span> <span class="mi">2_000</span>
            <span class="n">noise_y</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="k">class</span> <span class="nc">ExpParams</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;line&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;circ&quot;</span><span class="p">,</span>
                <span class="c1"># &quot;rand&quot;</span>
            <span class="p">]</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">method</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hsic&quot;</span><span class="p">,</span> <span class="s2">&quot;tka&quot;</span><span class="p">,</span> <span class="s2">&quot;ctka&quot;</span><span class="p">]</span>
            <span class="n">gamma_method</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">]</span>

    <span class="c1"># Case II - Unscaled, Normalized</span>
    <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

        <span class="k">class</span> <span class="nc">DataParams</span><span class="p">:</span>
            <span class="n">num_points</span> <span class="o">=</span> <span class="mi">2_000</span>
            <span class="n">noise_y</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="k">class</span> <span class="nc">ExpParams</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;line&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;circ&quot;</span><span class="p">,</span>
                <span class="c1"># &quot;rand&quot;</span>
            <span class="p">]</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">]</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">method</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hsic&quot;</span><span class="p">,</span> <span class="s2">&quot;tka&quot;</span><span class="p">,</span> <span class="s2">&quot;ctka&quot;</span><span class="p">]</span>
            <span class="n">gamma_method</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">]</span>

    <span class="c1"># Case III - Scaled, Unnormalized</span>
    <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

        <span class="k">class</span> <span class="nc">DataParams</span><span class="p">:</span>
            <span class="n">num_points</span> <span class="o">=</span> <span class="mi">2_000</span>
            <span class="n">noise_y</span> <span class="o">=</span> <span class="mf">0.01</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="k">class</span> <span class="nc">ExpParams</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;line&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;circ&quot;</span><span class="p">,</span>
                <span class="c1"># &quot;rand&quot;,</span>
            <span class="p">]</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">]</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">method</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hsic&quot;</span><span class="p">,</span> <span class="s2">&quot;tka&quot;</span><span class="p">,</span> <span class="s2">&quot;ctka&quot;</span><span class="p">]</span>
            <span class="n">gamma_method</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">]</span>

    <span class="k">elif</span> <span class="n">case</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>

        <span class="k">class</span> <span class="nc">DataParams</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="s2">&quot;line&quot;</span>
            <span class="n">num_points</span> <span class="o">=</span> <span class="mi">2_000</span>
            <span class="n">noise_y</span> <span class="o">=</span> <span class="mf">0.01</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="k">class</span> <span class="nc">ExpParams</span><span class="p">:</span>
            <span class="n">dataset</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">&quot;line&quot;</span><span class="p">,</span>
                <span class="s2">&quot;sine&quot;</span><span class="p">,</span>
                <span class="s2">&quot;circ&quot;</span><span class="p">,</span>
                <span class="c1"># &quot;rand&quot;</span>
            <span class="p">]</span>
            <span class="n">seed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>  <span class="c1"># [0.01, 1.0, 100.0]</span>
            <span class="n">normalized</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
            <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
            <span class="n">method</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hsic&quot;</span><span class="p">,</span> <span class="s2">&quot;tka&quot;</span><span class="p">,</span> <span class="s2">&quot;ctka&quot;</span><span class="p">]</span>
            <span class="n">gamma_method</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
                <span class="p">(</span><span class="s2">&quot;median&quot;</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unrecognized case: &#39;</span><span class="si">{</span><span class="n">case</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h4 id="case-i-unscaled-unnormalized">Case I - Unscaled, Unnormalized<a class="headerlink" href="#case-i-unscaled-unnormalized" title="Permanent link">&para;</a></h4>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
For this first walkthrough, we are assuming that the data is unscaled and that the data is unnormalized.</p>
<p><strong>Hypothesis</strong>: We all methods should showcase some relationship to the amount of Mutual information but it will not necessarily be a strict relationship. Thinking from the previous results, the KA method should perform the worst, the HSIC method should perform OK with some inconsistencies and the CKA should perform the best and showcase a trend.
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># case number</span>
<span class="n">case</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># get parameters</span>
<span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">case</span><span class="o">=</span><span class="n">case</span><span class="p">)</span>

<span class="c1"># Initialize Experiment class</span>
<span class="n">exp_class</span> <span class="o">=</span> <span class="n">ScaleExperiment</span><span class="p">(</span><span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span><span class="p">,</span> <span class="p">)</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">run_experiment</span><span class="p">()</span>
</code></pre></div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">results_df</span>
</code></pre></div>

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110588</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.105917</td>
      <td>3.074389</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999368</td>
      <td>3.074389</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998062</td>
      <td>3.074389</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110391</td>
      <td>3.111298</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999400</td>
      <td>3.111298</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998244</td>
      <td>3.111298</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h4 id="case-ii-unscaled-normalized">Case II - Unscaled, Normalized<a class="headerlink" href="#case-ii-unscaled-normalized" title="Permanent link">&para;</a></h4>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
In this case, we see that
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

</div>
</div>
<div class="highlight"><pre><span></span><code><span class="c1"># case number</span>
<span class="n">case</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># get parameters</span>
<span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">case</span><span class="o">=</span><span class="n">case</span><span class="p">)</span>

<span class="c1"># Initialize Experiment class</span>
<span class="n">exp_class</span> <span class="o">=</span> <span class="n">ScaleExperiment</span><span class="p">(</span><span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span><span class="p">,</span> <span class="p">)</span>

<span class="c1"># Run experiment</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">run_experiment</span><span class="p">()</span>
</code></pre></div>

</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">results_df</span>
</code></pre></div>

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110589</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.089667</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.946835</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.843181</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.003926</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.686470</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.040370</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h4 id="case-iii-scaled-unormalized">Case III - Scaled, Unormalized<a class="headerlink" href="#case-iii-scaled-unormalized" title="Permanent link">&para;</a></h4>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># case number</span>
<span class="n">case</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># get parameters</span>
<span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">case</span><span class="o">=</span><span class="n">case</span><span class="p">)</span>

<span class="c1"># Initialize Experiment class</span>
<span class="n">exp_class</span> <span class="o">=</span> <span class="n">ScaleExperiment</span><span class="p">(</span><span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span><span class="p">,</span> <span class="p">)</span>

<span class="c1"># Run Experiment</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">run_experiment</span><span class="p">()</span>
</code></pre></div>

</div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">results_df</span>
</code></pre></div>

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>1.109297e-04</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.316801e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.369142e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>1.105885e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>9.993656e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>9.981718e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>1.099729e-04</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.323451e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.371835e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>8.439792e-05</td>
      <td>0.963049</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.369820e-01</td>
      <td>0.963049</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>5.583300e-01</td>
      <td>0.963049</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>8.954440e-02</td>
      <td>1.043494</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>9.467536e-01</td>
      <td>1.043494</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>8.424410e-01</td>
      <td>1.043494</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>1.074575e-04</td>
      <td>1.005067</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.325034e-01</td>
      <td>1.005067</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>5.704429e-01</td>
      <td>1.005067</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>4.451921e-07</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.299457e-01</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>3.129644e-02</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>2.026650e-03</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.870766e-01</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>3.598772e-02</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>8.407697e-05</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.384854e-01</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>4.028872e-02</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></p>
<h4 id="case-iv-scaled-normalized">Case IV - Scaled, Normalized<a class="headerlink" href="#case-iv-scaled-normalized" title="Permanent link">&para;</a></h4>
<p></div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="c1"># case number</span>
<span class="n">case</span> <span class="o">=</span> <span class="mi">4</span>

<span class="c1"># get parameters</span>
<span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span> <span class="o">=</span> <span class="n">get_params</span><span class="p">(</span><span class="n">case</span><span class="o">=</span><span class="n">case</span><span class="p">)</span>

<span class="c1"># Initialize Experiment class</span>
<span class="n">exp_class</span> <span class="o">=</span> <span class="n">ScaleExperiment</span><span class="p">(</span><span class="n">DataParams</span><span class="p">,</span> <span class="n">ExpParams</span><span class="p">,</span> <span class="p">)</span>

<span class="c1"># Run Experiment</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">exp_class</span><span class="o">.</span><span class="n">run_experiment</span><span class="p">()</span>
</code></pre></div>

</div>

</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code><span class="n">results_df</span>
</code></pre></div>

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110589</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110589</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110589</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.089667</td>
      <td>1.036774</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.946835</td>
      <td>1.036774</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.843181</td>
      <td>1.036774</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.089667</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.946835</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.843181</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.089667</td>
      <td>1.036760</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.946835</td>
      <td>1.036760</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.843181</td>
      <td>1.036760</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.003926</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.686470</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.040370</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.003926</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.686470</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.040370</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.003926</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.686470</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.040370</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="highlight"><pre><span></span><code>
</code></pre></div>

</div>

</div>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../2.0_scale_viz/" title="2.0 scale viz" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                2.0 scale viz
              </div>
            </div>
          </a>
        
        
          <a href="../old/1.0_scale_walk/" title="1.0 scale walk" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                1.0 scale walk
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 J. Emmanuel Johnson
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/jejjohnson" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
      <a href="https://twitter.com/jejjohnson" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
      <a href="https://linkedin.com/in/jejjohnson" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
      <a href="https://jejjohnson.netlify.com" target="_blank" rel="noopener" title="jejjohnson.netlify.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/vendor.f81b9e8b.min.js"></script>
      <script src="../../../assets/javascripts/bundle.23546af0.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../../..",
          features: [],
          search: Object.assign({
            worker: "../../../assets/javascripts/worker/search.58d22e8e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../../javascripts/extra.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>