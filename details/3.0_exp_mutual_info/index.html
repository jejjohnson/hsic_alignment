


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Motivation for this study">
      
      
        <link rel="canonical" href="https://jejjohnson.github.io/hsic_alignment/details/3.0_exp_mutual_info/">
      
      
        <meta name="author" content="J. Emmanuel Johnson">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.3">
    
    
      
        <title>Full Experiment Walkthrough</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.62d34fff.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.c8acc6db.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=source+code+pro:300,400,400i,700%7Csource+code+pro&display=fallback">
        <style>body,input{font-family:"source code pro",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"source code pro",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../css/ansi-colours.css">
    
      <link rel="stylesheet" href="../../css/jupyter-cells.css">
    
      <link rel="stylesheet" href="../../css/pandas-dataframe.css">
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="gray">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#walkthrough-experiment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://jejjohnson.github.io/hsic_alignment" title="HSIC Alignment" class="md-header-nav__button md-logo" aria-label="HSIC Alignment">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z" /></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            HSIC Alignment
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Full Experiment Walkthrough
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z" /></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" /></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/jejjohnson/hsic_alignment/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jejjohnson/hsic_alignment
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://jejjohnson.github.io/hsic_alignment" title="HSIC Alignment" class="md-nav__button md-logo" aria-label="HSIC Alignment">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z" /></svg>

    </a>
    HSIC Alignment
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/jejjohnson/hsic_alignment/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    jejjohnson/hsic_alignment
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Details
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Details" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Details
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../1.0_motivation/" title="Motivation" class="md-nav__link">
      Motivation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../2.0_preliminary_exp/" title="1D Parameter Space" class="md-nav__link">
      1D Parameter Space
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Full Experiment Walkthrough
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z" /></svg>
        </span>
      </label>
    
    <a href="./" title="Full Experiment Walkthrough" class="md-nav__link md-nav__link--active">
      Full Experiment Walkthrough
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#experimental-parameters" class="md-nav__link">
    Experimental Parameters
  </a>
  
    <nav class="md-nav" aria-label="Experimental Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-i-hsic-estimator" class="md-nav__link">
    Case I - HSIC Estimator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-ii-sigma-estimator" class="md-nav__link">
    Case II - Sigma Estimator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-iii-sigma-application" class="md-nav__link">
    Case III - Sigma Application
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-iv-standardize-or-not-standardize" class="md-nav__link">
    Case IV - Standardize or not Standardize
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-v-multivariate-datasets" class="md-nav__link">
    Case V - Multivariate Datasets
  </a>
  
    <nav class="md-nav" aria-label="Case V - Multivariate Datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-loop-update" class="md-nav__link">
    Main Loop (Update)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experiment" class="md-nav__link">
    Experiment
  </a>
  
    <nav class="md-nav" aria-label="Experiment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-single-step" class="md-nav__link">
    Test - Single Step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-full-loop" class="md-nav__link">
    Test - Full Loop
  </a>
  
    <nav class="md-nav" aria-label="Test - Full Loop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appending-to-file" class="md-nav__link">
    Appending to File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../4.0_dist_vs_mi/" title="Mutual Info vs Scores" class="md-nav__link">
      Mutual Info vs Scores
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Notebooks
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Notebooks" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Notebooks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      1 1D parameter
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="1 1D parameter" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        1 1D parameter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/1_1D_parameter/1.0_motivation/" title="1.0 motivation" class="md-nav__link">
      1.0 motivation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/1_1D_parameter/2.0_preliminary_exp/" title="2.0 preliminary exp" class="md-nav__link">
      2.0 preliminary exp
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      2 gamma parameter
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="2 gamma parameter" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        2 gamma parameter
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/2_gamma_parameter/1_explore_exp/" title="1 explore exp" class="md-nav__link">
      1 explore exp
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/2_gamma_parameter/2_visualize_1l/" title="2 visualize 1l" class="md-nav__link">
      2 visualize 1l
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/2_gamma_parameter/2_visualize_20k/" title="2 visualize 20k" class="md-nav__link">
      2 visualize 20k
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/2_gamma_parameter/gamma_trial_experiment/" title="Gamma trial experiment" class="md-nav__link">
      Gamma trial experiment
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3" type="checkbox" id="nav-3-3">
    
    <label class="md-nav__link" for="nav-3-3">
      3 isotropic scaling
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="3 isotropic scaling" data-md-level="2">
      <label class="md-nav__title" for="nav-3-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        3 isotropic scaling
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/3_isotropic_scaling/0_preliminary_exp-Copy1/" title="0 preliminary exp Copy1" class="md-nav__link">
      0 preliminary exp Copy1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/3_isotropic_scaling/2.0_scale_viz/" title="2.0 scale viz" class="md-nav__link">
      2.0 scale viz
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/3_isotropic_scaling/3.0_scale_walk/" title="3.0 scale walk" class="md-nav__link">
      3.0 scale walk
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-3-4" type="checkbox" id="nav-3-3-4">
    
    <label class="md-nav__link" for="nav-3-3-4">
      Old
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Old" data-md-level="3">
      <label class="md-nav__title" for="nav-3-3-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Old
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/3_isotropic_scaling/old/1.0_scale_walk/" title="1.0 scale walk" class="md-nav__link">
      1.0 scale walk
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4" type="checkbox" id="nav-3-4">
    
    <label class="md-nav__link" for="nav-3-4">
      4 distributions
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="4 distributions" data-md-level="2">
      <label class="md-nav__title" for="nav-3-4">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        4 distributions
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/2.1_exp_gamma_space/" title="2.1 exp gamma space" class="md-nav__link">
      2.1 exp gamma space
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/2.2_exp_mutual_info/" title="2.2 exp mutual info" class="md-nav__link">
      2.2 exp mutual info
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/2.3_viz_mutual_info/" title="2.3 viz mutual info" class="md-nav__link">
      2.3 viz mutual info
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/untitled/" title="Untitled" class="md-nav__link">
      Untitled
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-4-5" type="checkbox" id="nav-3-4-5">
    
    <label class="md-nav__link" for="nav-3-4-5">
      Old
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Old" data-md-level="3">
      <label class="md-nav__title" for="nav-3-4-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Old
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/old/0_demo/" title="0 demo" class="md-nav__link">
      0 demo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/old/2.1_exp_walkthrough/" title="2.1 exp walkthrough" class="md-nav__link">
      2.1 exp walkthrough
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/old/3.1_trial_experiment/" title="3.1 trial experiment" class="md-nav__link">
      3.1 trial experiment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/old/3_exp_dimensions/" title="3 exp dimensions" class="md-nav__link">
      3 exp dimensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/old/4_visualize_dimensions/" title="4 visualize dimensions" class="md-nav__link">
      4 visualize dimensions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/4_distributions/old/4_visualize_dimensions_original/" title="4 visualize dimensions original" class="md-nav__link">
      4 visualize dimensions original
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-5" type="checkbox" id="nav-3-5">
    
    <label class="md-nav__link" for="nav-3-5">
      Code reviews
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Code reviews" data-md-level="2">
      <label class="md-nav__title" for="nav-3-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Code reviews
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/code_reviews/1.0_estimate_sigma/" title="1.0 estimate sigma" class="md-nav__link">
      1.0 estimate sigma
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/code_reviews/2.0_estimate_hsic/" title="2.0 estimate hsic" class="md-nav__link">
      2.0 estimate hsic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/code_reviews/3.0_multivariate_dists/" title="3.0 multivariate dists" class="md-nav__link">
      3.0 multivariate dists
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/code_reviews/4.1_params_gauss/" title="4.1 params gauss" class="md-nav__link">
      4.1 params gauss
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/code_reviews/4.2_params_tstudent/" title="4.2 params tstudent" class="md-nav__link">
      4.2 params tstudent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/code_reviews/5.0_fitting_mi/" title="5.0 fitting mi" class="md-nav__link">
      5.0 fitting mi
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-6" type="checkbox" id="nav-3-6">
    
    <label class="md-nav__link" for="nav-3-6">
      Demos
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Demos" data-md-level="2">
      <label class="md-nav__title" for="nav-3-6">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Demos
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/demos/1_hsic-Copy1/" title="1 hsic Copy1" class="md-nav__link">
      1 hsic Copy1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/demos/2_estimate_sigma/" title="2 estimate sigma" class="md-nav__link">
      2 estimate sigma
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3-7" type="checkbox" id="nav-3-7">
    
    <label class="md-nav__link" for="nav-3-7">
      Ite toolbox
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" /></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Ite toolbox" data-md-level="2">
      <label class="md-nav__title" for="nav-3-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
        </span>
        Ite toolbox
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/ite_toolbox/0_demo/" title="0 demo" class="md-nav__link">
      0 demo
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/ite_toolbox/1_fake_distributions/" title="1 fake distributions" class="md-nav__link">
      1 fake distributions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../notebooks/ite_toolbox/Untitled/" title="Untitled" class="md-nav__link">
      Untitled
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#experimental-parameters" class="md-nav__link">
    Experimental Parameters
  </a>
  
    <nav class="md-nav" aria-label="Experimental Parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#case-i-hsic-estimator" class="md-nav__link">
    Case I - HSIC Estimator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-ii-sigma-estimator" class="md-nav__link">
    Case II - Sigma Estimator
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-iii-sigma-application" class="md-nav__link">
    Case III - Sigma Application
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#case-iv-standardize-or-not-standardize" class="md-nav__link">
    Case IV - Standardize or not Standardize
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#case-v-multivariate-datasets" class="md-nav__link">
    Case V - Multivariate Datasets
  </a>
  
    <nav class="md-nav" aria-label="Case V - Multivariate Datasets">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-loop-update" class="md-nav__link">
    Main Loop (Update)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#experiment" class="md-nav__link">
    Experiment
  </a>
  
    <nav class="md-nav" aria-label="Experiment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-single-step" class="md-nav__link">
    Test - Single Step
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-full-loop" class="md-nav__link">
    Test - Full Loop
  </a>
  
    <nav class="md-nav" aria-label="Test - Full Loop">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#appending-to-file" class="md-nav__link">
    Appending to File
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/jejjohnson/hsic_alignment/edit/master/docs/details/3.0_exp_mutual_info.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" /></svg>
                  </a>
                
                
                  
                    


  


<a href="https://github.com/jejjohnson/hsic_alignment/docs/projects/similarity/kernel_alignment_params/notebooks/3.0_exp_mutual_info.md" title="3.0_exp_mutual_info.md" class="md-content__button md-icon">
  Source
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
</a>
                  
                
                
                <h1 id="walkthrough-experiment">Walkthrough - Experiment<a class="headerlink" href="#walkthrough-experiment" title="Permanent link">&para;</a></h1>
<p>In this notebook, I will walk-through my experimental procedure.</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>

<span class="c1"># Insert path to model directory,.</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="n">path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cwd</span><span class="si">}</span><span class="s2">/../../src&quot;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>

<span class="c1"># Insert path to package,.</span>
<span class="n">pysim_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/home/emmanuel/code/pysim/&quot;</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pysim_path</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">sklearn.utils</span> <span class="kn">import</span> <span class="n">check_random_state</span>

<span class="c1"># toy datasets</span>
<span class="kn">from</span> <span class="nn">data.distribution</span> <span class="kn">import</span> <span class="n">DataParams</span><span class="p">,</span> <span class="n">Inputs</span>

<span class="c1"># Kernel Dependency measure</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.gaussian_process.kernels</span> <span class="kn">import</span> <span class="n">RBF</span>
<span class="kn">from</span> <span class="nn">models.dependence</span> <span class="kn">import</span> <span class="n">HSICModel</span>
<span class="kn">from</span> <span class="nn">pysim.kernel.utils</span> <span class="kn">import</span> <span class="n">estimate_sigma</span>

<span class="c1"># RBIG IT measures</span>
<span class="c1"># from models.ite_algorithms import run_rbig_models</span>

<span class="c1"># Plotting</span>
<span class="kn">from</span> <span class="nn">visualization.distribution</span> <span class="kn">import</span> <span class="n">plot_scorer</span>

<span class="c1"># experiment helpers</span>
<span class="kn">from</span> <span class="nn">experiments.utils</span> <span class="kn">import</span> <span class="n">dict_product</span><span class="p">,</span> <span class="n">run_parallel_step</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="c1"># Plotting Procedures</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">([</span><span class="s1">&#39;seaborn-talk&#39;</span><span class="p">])</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># get rid of annoying warnings</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># get rid of annoying warnings</span>

<span class="o">%</span><span class="n">load_ext</span> <span class="n">autoreload</span>
<span class="o">%</span><span class="n">autoreload</span> <span class="mi">2</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">!</span><span class="n">pwd</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>/home/emmanuel/projects/2019_hsic_align/notebooks/4_distributions
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="n">FIG_PATH</span> <span class="o">=</span> <span class="s2">&quot;/home/emmanuel/projects/2019_hsic_align/results/figures/distribution_experiment/mutual_info/&quot;</span>
<span class="n">RES_PATH</span> <span class="o">=</span> <span class="s2">&quot;/home/emmanuel/projects/2019_hsic_align/data/results/distributions/mutual_info/&quot;</span>
</code></pre></div>

<h3 id="experimental-parameters">Experimental Parameters<a class="headerlink" href="#experimental-parameters" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># initialize the holder for the parameters</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div>

<h4 id="case-i-hsic-estimator">Case I - HSIC Estimator<a class="headerlink" href="#case-i-hsic-estimator" title="Permanent link">&para;</a></h4>
<p>In this first part, we have 3 cases of HSIC as a combination of a centered kernel and whether or not we normalize the covariance term. The 3 "scorers" are as follows:</p>
<ol>
<li><strong>HSIC</strong></li>
</ol>
<div>
<div class="MathJax_Preview">HSIC = \frac{1}{n(n-1)}\langle K_xH,K_yH \rangle_F</div>
<script type="math/tex; mode=display">HSIC = \frac{1}{n(n-1)}\langle K_xH,K_yH \rangle_F</script>
</div>
<blockquote>
<p>In this case, the kernels are <strong>centered</strong>, but the score is <strong>not normalized</strong>.</p>
</blockquote>
<ol>
<li><strong>Kernel Alignment</strong> (KA) </li>
</ol>
<div>
<div class="MathJax_Preview">TKA = \frac{\langle K_x,K_y \rangle_F}{||K_x||_F||K_y||_F}</div>
<script type="math/tex; mode=display">TKA = \frac{\langle K_x,K_y \rangle_F}{||K_x||_F||K_y||_F}</script>
</div>
<blockquote>
<p>In this case, the kernels are <strong>not centered</strong> but the score is <strong>normalized</strong>.</p>
</blockquote>
<ol>
<li><strong>cTKA</strong></li>
</ol>
<div>
<div class="MathJax_Preview">cTKA = \frac{\langle K_xH,K_yH \rangle_F}{||K_xH||_F||K_yH||_F}</div>
<script type="math/tex; mode=display">cTKA = \frac{\langle K_xH,K_yH \rangle_F}{||K_xH||_F||K_yH||_F}</script>
</div>
<blockquote>
<p>In this case, the kernels are <strong>centered</strong> and the score is <strong>normalized</strong>.</p>
</blockquote>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_hsic</span><span class="p">(</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">scorer</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> 
    <span class="n">sigma_X</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
    <span class="n">sigma_Y</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Estimates the HSIC value given some data, sigma and</span>
<span class="sd">    the score.&quot;&quot;&quot;</span>
    <span class="c1"># init hsic model class</span>

    <span class="n">hsic_model</span> <span class="o">=</span> <span class="n">HSICModel</span><span class="p">()</span>
    <span class="c1"># hsic model params</span>
    <span class="k">if</span> <span class="n">sigma_X</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

        <span class="n">hsic_model</span><span class="o">.</span><span class="n">kernel_X</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">(</span><span class="n">sigma_X</span><span class="p">)</span>
        <span class="n">hsic_model</span><span class="o">.</span><span class="n">kernel_Y</span> <span class="o">=</span> <span class="n">RBF</span><span class="p">(</span><span class="n">sigma_Y</span><span class="p">)</span>

    <span class="c1"># get hsic score</span>
    <span class="n">hsic_val</span> <span class="o">=</span> <span class="n">hsic_model</span><span class="o">.</span><span class="n">get_score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">scorer</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">hsic_val</span>

<span class="c1"># parameters</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;scorer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;hsic&#39;</span><span class="p">,</span> <span class="s1">&#39;ka&#39;</span><span class="p">,</span> <span class="s1">&#39;cka&#39;</span><span class="p">]</span> 
</code></pre></div>

<h4 id="case-ii-sigma-estimator">Case II - Sigma Estimator<a class="headerlink" href="#case-ii-sigma-estimator" title="Permanent link">&para;</a></h4>
<p>For this parameter, we are interested in estimating a few things:</p>
<ol>
<li>We want to know which estimator to choose from.</li>
</ol>
<p>Kernel methods are great if the parameters of the kernel are correct. In supervised scenarios, we can simply learn the appropriate kernel parameters that best fit our data given some criteria. In unsupervised settings, we generally do not know which parameters to choose from. But there are many different ways to choose the parameters as every lab/researcher has their own method that "they swear by". I will choose some of the most common ones: </p>
<ul>
<li>Silverman</li>
<li>Scott</li>
<li>Mean Distance</li>
<li>Median Distance</li>
<li>Median Distance with the <span><span class="MathJax_Preview">k^{th}</span><script type="math/tex">k^{th}</script></span> sample (or percent) of that distance matrix.</li>
</ul>
<h4 id="case-iii-sigma-application">Case III - Sigma Application<a class="headerlink" href="#case-iii-sigma-application" title="Permanent link">&para;</a></h4>
<ol>
<li>We want to know the how we are applying the length scale.</li>
</ol>
<p>We have three cases to consider:</p>
<ul>
<li>One length scale for both datasets</li>
<li>One length scale per dataset</li>
<li>One length scale per dataset per dimension</li>
</ul>
<p>This is important as it could turn a good estimator into a bad estimator. Scott and Silverman work very well for univariate distributions but not very well for multivariate distributions. So if we have one scott/silverman estimate per feature, then this estimator might be a lot better and yield much better results. For the case of the RBF kernel, having one length scale per dimension corresponds to the ARD Kernel which assigns a length scale (or relevance values) per feature. We don't typically use the ARD kernel for kernel methods that we cannot optimize using some gradient function due to how expensive it is. But in this case, it isn't so expensive because we are choosing not to optimizing anything.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_sigma</span><span class="p">(</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">method</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;silverman&#39;</span><span class="p">,</span> 
    <span class="n">percent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">per_dimension</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
    <span class="n">separate_scales</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="c1"># sigma parameters</span>
    <span class="n">subsample</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">random_state</span> <span class="o">=</span> <span class="mi">123</span>

    <span class="n">sigma_X</span> <span class="o">=</span> <span class="n">estimate_sigma</span><span class="p">(</span>
        <span class="n">X</span><span class="p">,</span> 
        <span class="n">subsample</span><span class="o">=</span><span class="n">subsample</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">percent</span><span class="o">=</span><span class="n">percent</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
        <span class="n">per_dimension</span><span class="o">=</span><span class="n">per_dimension</span>
    <span class="p">)</span>

    <span class="n">sigma_Y</span> <span class="o">=</span> <span class="n">estimate_sigma</span><span class="p">(</span>
        <span class="n">Y</span><span class="p">,</span> 
        <span class="n">subsample</span><span class="o">=</span><span class="n">subsample</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">percent</span><span class="o">=</span><span class="n">percent</span><span class="p">,</span>
        <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span>
        <span class="n">per_dimension</span><span class="o">=</span><span class="n">per_dimension</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">separate_scales</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">sigma_Y</span> <span class="o">=</span> <span class="n">sigma_X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="n">sigma_X</span><span class="p">,</span> <span class="n">sigma_Y</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">sigma_X</span><span class="p">,</span> <span class="n">sigma_Y</span>

<span class="c1"># Parameters for the estimators</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;sigma_estimator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
<span class="c1">#     (&#39;silverman&#39;,None),</span>
<span class="c1">#     (&#39;scott&#39;, None),</span>
    <span class="o">*</span><span class="p">[(</span><span class="s1">&#39;median&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)]</span>
<span class="p">]</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;separate_scales&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;per_dimension&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
</code></pre></div>

<h4 id="case-iv-standardize-or-not-standardize">Case IV - Standardize or not Standardize<a class="headerlink" href="#case-iv-standardize-or-not-standardize" title="Permanent link">&para;</a></h4>
<p>This is a simple case but it can have drastic changes in the results of estimating the length scale. In ML, we tend to standardize our datasets because the algorithms do better with predictions with the ranges are contained. Datasets with massive values for certain features could have adverse affects on the representation and the predictions. The formula is given by:</p>
<div>
<div class="MathJax_Preview">\bar{x} = \frac{x - \mu_x}{\sigma_x}</div>
<script type="math/tex; mode=display">\bar{x} = \frac{x - \mu_x}{\sigma_x}</script>
</div>
<p><strong>Note</strong>: this is scaling per feature and not per sample. </p>
<div class="highlight"><pre><span></span><code><span class="c1"># from typing import Tuple, Optional</span>

<span class="k">def</span> <span class="nf">standardize_data</span><span class="p">(</span>
    <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">Y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> 
    <span class="n">standardize</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>

<span class="c1"># experimental parameters</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;standardize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span>
</code></pre></div>

<h3 id="case-v-multivariate-datasets">Case V - Multivariate Datasets<a class="headerlink" href="#case-v-multivariate-datasets" title="Permanent link">&para;</a></h3>
<p>For this experiment, we have generated samples for two sets of multivariate distributions: the Gaussian and the T-Student. We have varied the parameters so that we get a variety of samples, dimensions and the amount of similarity (that we can analytically calculate) between them. </p>
<p>For example, we can take a Gaussian distribution with a covariance and generate a similar Gaussian distribution with the same number of samples and variance with a covariance. We know the cross-covariance between them and the self-covariances, so we can analytically calculate the mutual information between the two. MI is absolute which is the dependence or similarity between the two datasets. Now, we will see how the HSIC scores will do versus this variation of dataset size and shape. </p>
<p>We have the following parameters:</p>
<p><center></p>
<table>
<thead>
<tr>
<th align="center">Parameter</th>
<th align="center">Entry</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Samples</td>
<td align="center">50, 100, 500, 1K, 5K</td>
</tr>
<tr>
<td align="center">Dimensions</td>
<td align="center">2, 3, 10, 50, 100</td>
</tr>
<tr>
<td align="center">Trials</td>
<td align="center">1 <span><span class="MathJax_Preview">\rightarrow</span><script type="math/tex">\rightarrow</script></span> 5</td>
</tr>
<tr>
<td align="center">Distributions</td>
<td align="center">Gaussian, T-Student</td>
</tr>
<tr>
<td align="center">std (Gauss dist)</td>
<td align="center">1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11</td>
</tr>
<tr>
<td align="center">nu (T-Stu dist)</td>
<td align="center">1, 2, 3, 4, 5, 6, 7, 8, 9</td>
</tr>
</tbody>
</table>
<p></center></p>
<div class="highlight"><pre><span></span><code><span class="c1"># example parameters for the dataset</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gauss&#39;</span><span class="p">]</span> 
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span> 
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;trial&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;dimensions&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>

<span class="n">loop_params</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1_000</span><span class="p">,</span> <span class="mi">5_000</span><span class="p">]</span>

<span class="c1"># example parameters function</span>
<span class="n">example_params</span> <span class="o">=</span> <span class="n">DataParams</span><span class="p">()</span>

<span class="c1"># generates a named tuple containing the inputs and the MI </span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">example_params</span><span class="o">.</span><span class="n">generate_data</span><span class="p">()</span>
</code></pre></div>

<h4 id="main-loop-update">Main Loop (<strong>Update</strong>)<a class="headerlink" href="#main-loop-update" title="Permanent link">&para;</a></h4>
<p>So it turns out just doing a blind parallel scheme ended up taking too much time. So I decided to break the problem up a bit. </p>
<ol>
<li>Do 1 Main Loop (Samples)</li>
</ol>
<p>I decided not to combine all of the combinations; I did all except for the number of samples. Everytime I was watching the progress bar, it would slow down every once in a while. That was because the bottleneck for kernel methods is the number of samples. We have cases of 1_000 which isn't too bad, but 5_000 samples is where the methods really start to slow down. In addition, there will be a lot of memory consumption. So I decided to do a main loop through the number of samples (starting from the smallest and ending with the largest). That way, we can get the easier datasets out of the way and then work on the larger datasets later.</p>
<ol>
<li>Controlling the number of jobs.</li>
</ol>
<p>As I mentioned before, the bottleneck is the number of samples. With 5_000, this starts to eat up a lot of memory when doing this in parallel. So to prevent this I set it up such that I control the number of cores doing the processing. Like so:</p>
<p><center></p>
<table>
<thead>
<tr>
<th align="center"># Samples</th>
<th align="center">Cores</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">50</td>
<td align="center">28</td>
</tr>
<tr>
<td align="center">100</td>
<td align="center">28</td>
</tr>
<tr>
<td align="center">500</td>
<td align="center">28</td>
</tr>
<tr>
<td align="center">1_000</td>
<td align="center">16</td>
</tr>
<tr>
<td align="center">5_000</td>
<td align="center">8</td>
</tr>
</tbody>
</table>
<p></center></p>
<ol>
<li>Appending Data</li>
</ol>
<p>Because there was a lot of data being shifted around (<span><span class="MathJax_Preview">\sim 297000</span><script type="math/tex">\sim 297000</script></span> parameters), the resulting <code>dataframe</code> which stores the experimental results is going to be huge. So I decided that for every call to the main loop, I will run append those results to a csv file and then del that dataframe to free up memory.</p>
<h2 id="experiment">Experiment<a class="headerlink" href="#experiment" title="Permanent link">&para;</a></h2>
<p>We have a lot of parameters. So we are going to run everything in parallel so that we can save time. We will do this by giving the cartesian product of our nD list of parameters. This will give us a list of tuples where each entry is a set of parameters to evaluate. The length of this list will be the total number of parameters.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># create a list of all param combinations</span>
<span class="n">parameters_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dict_product</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
<span class="n">n_params</span><span class="p">,</span> <span class="n">n_loop_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">loop_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;# of Params:&#39;</span><span class="p">,</span> <span class="n">n_params</span><span class="p">,</span> <span class="n">n_loop_params</span><span class="p">)</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code># of Params: 59400 5
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span> 

<span class="k">def</span> <span class="nf">step</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">loop_param</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>

    <span class="c1"># ================</span>
    <span class="c1"># DATA</span>
    <span class="c1"># ================    </span>
    <span class="n">dist_data</span> <span class="o">=</span> <span class="n">DataParams</span><span class="p">(</span>
    <span class="n">dataset</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;dataset&#39;</span><span class="p">],</span>
    <span class="n">trial</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;trial&#39;</span><span class="p">],</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">],</span>
    <span class="n">nu</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">],</span>
    <span class="n">samples</span> <span class="o">=</span> <span class="n">loop_param</span><span class="p">,</span>
    <span class="n">dimensions</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;dimensions&#39;</span><span class="p">],</span>
    <span class="p">)</span>

    <span class="c1"># generate data</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">dist_data</span><span class="o">.</span><span class="n">generate_data</span><span class="p">()</span>


    <span class="c1"># ====================</span>
    <span class="c1"># Sigma Estimator</span>
    <span class="c1"># ====================</span>

    <span class="c1"># estimate sigma</span>
    <span class="n">sigma_X</span><span class="p">,</span> <span class="n">sigma_Y</span> <span class="o">=</span> <span class="n">get_sigma</span><span class="p">(</span>
        <span class="n">X</span><span class="o">=</span><span class="n">inputs</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="o">=</span><span class="n">inputs</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> 
        <span class="n">method</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sigma_estimator&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> 
        <span class="n">percent</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sigma_estimator&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> 
        <span class="n">per_dimension</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;per_dimension&#39;</span><span class="p">],</span>
        <span class="n">separate_scales</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;separate_scales&#39;</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="c1"># ====================</span>
    <span class="c1"># HSIC Model</span>
    <span class="c1"># ====================</span>
    <span class="c1"># get hsic score</span>
    <span class="n">score</span> <span class="o">=</span> <span class="n">get_hsic</span><span class="p">(</span>
        <span class="n">inputs</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">inputs</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> 
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;scorer&#39;</span><span class="p">],</span> 
        <span class="n">sigma_X</span><span class="p">,</span> <span class="n">sigma_Y</span>
    <span class="p">)</span>

    <span class="c1"># ====================</span>
    <span class="c1"># Results</span>
    <span class="c1"># ====================</span>

    <span class="c1"># append results to dataframe</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="p">{</span>
            <span class="c1"># Data Params</span>
            <span class="s2">&quot;dataset&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;trial&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;trial&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;std&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;std&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;nu&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;nu&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;samples&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">loop_param</span><span class="p">],</span>
            <span class="s2">&quot;dimensions&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">]],</span>
            <span class="c1"># STANDARDIZE PARSM</span>
            <span class="s2">&quot;standardize&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;standardize&quot;</span><span class="p">]],</span>
            <span class="c1"># SIGMA FORMAT PARAMS</span>
            <span class="s2">&quot;per_dimension&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;per_dimension&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;separate_scales&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;separate_scales&quot;</span><span class="p">]],</span>
            <span class="c1"># SIGMA METHOD PARAMS</span>
            <span class="s2">&quot;sigma_method&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;sigma_estimator&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]],</span>
            <span class="s2">&quot;sigma_percent&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;sigma_estimator&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span>
            <span class="s2">&quot;sigma_X&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">sigma_X</span><span class="p">],</span>
            <span class="s2">&quot;sigma_Y&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">sigma_Y</span><span class="p">],</span>
            <span class="c1"># HSIC Params</span>
            <span class="s2">&quot;scorer&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;scorer&quot;</span><span class="p">]],</span>
            <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">score</span><span class="p">],</span>
            <span class="s2">&quot;mutual_info&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">inputs</span><span class="o">.</span><span class="n">mutual_info</span><span class="p">],</span>
        <span class="p">}</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">results_df</span>
</code></pre></div>

<h3 id="test-single-step">Test - Single Step<a class="headerlink" href="#test-single-step" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">iloop_param</span> <span class="ow">in</span> <span class="n">loop_params</span><span class="p">:</span>


    <span class="n">step_df</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">parameters_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iloop_param</span><span class="p">)</span>
<span class="c1">#     results_df = pd.concat([results_df, step_df])</span>
    <span class="k">break</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">step_df</span>
</code></pre></div>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>trial</th>
      <th>std</th>
      <th>nu</th>
      <th>samples</th>
      <th>dimensions</th>
      <th>standardize</th>
      <th>per_dimension</th>
      <th>separate_scales</th>
      <th>sigma_method</th>
      <th>sigma_percent</th>
      <th>sigma_X</th>
      <th>sigma_Y</th>
      <th>scorer</th>
      <th>score</th>
      <th>mutual_info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gauss</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>50</td>
      <td>2</td>
      <td>True</td>
      <td>True</td>
      <td>True</td>
      <td>median</td>
      <td>0.1</td>
      <td>[0.1686566316684468, 0.14612229488391992]</td>
      <td>[0.1589719949193001, 0.1680410083908699]</td>
      <td>hsic</td>
      <td>0.019091</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>

<h3 id="test-full-loop">Test - Full Loop<a class="headerlink" href="#test-full-loop" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n_jobs</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="k">with</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">loop_params</span><span class="p">)</span> <span class="k">as</span> <span class="n">pbar</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">iparam</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>

        <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;# Samples: </span><span class="si">{</span><span class="n">iparam</span><span class="si">}</span><span class="s2">, Tasks: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">parameters_list</span><span class="p">)</span><span class="si">}</span><span class="s2">, Jobs: </span><span class="si">{</span><span class="n">n_jobs</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="n">results_df</span> <span class="o">=</span> <span class="n">run_parallel_step</span><span class="p">(</span>
            <span class="n">exp_step</span><span class="o">=</span><span class="n">step</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="n">parameters_list</span><span class="p">,</span>
            <span class="n">n_jobs</span><span class="o">=</span><span class="n">n_jobs</span><span class="p">,</span>
            <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
            <span class="n">loop_param</span><span class="o">=</span><span class="n">iparam</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># concat current results</span>

        <span class="k">break</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code># Samples: 50, Tasks: 59400, Jobs: -1:   0%|          | 0/5 [00:00&lt;?, ?it/s][Parallel(n_jobs=-1)]: Using backend LokyBackend with 28 concurrent workers.
[Parallel(n_jobs=-1)]: Done 232 tasks      | elapsed:    0.9s
[Parallel(n_jobs=-1)]: Done 732 tasks      | elapsed:    1.9s
[Parallel(n_jobs=-1)]: Done 2024 tasks      | elapsed:    4.3s
[Parallel(n_jobs=-1)]: Done 3824 tasks      | elapsed:    7.6s
[Parallel(n_jobs=-1)]: Done 6024 tasks      | elapsed:   11.4s
[Parallel(n_jobs=-1)]: Done 8624 tasks      | elapsed:   15.8s
[Parallel(n_jobs=-1)]: Done 11624 tasks      | elapsed:   21.1s
[Parallel(n_jobs=-1)]: Done 15024 tasks      | elapsed:   27.4s
[Parallel(n_jobs=-1)]: Done 18824 tasks      | elapsed:   34.4s
[Parallel(n_jobs=-1)]: Done 23024 tasks      | elapsed:   41.9s
[Parallel(n_jobs=-1)]: Done 27624 tasks      | elapsed:   49.9s
[Parallel(n_jobs=-1)]: Done 32624 tasks      | elapsed:   59.4s
[Parallel(n_jobs=-1)]: Done 38024 tasks      | elapsed:  1.2min
[Parallel(n_jobs=-1)]: Done 43824 tasks      | elapsed:  1.3min
[Parallel(n_jobs=-1)]: Done 50024 tasks      | elapsed:  1.5min
[Parallel(n_jobs=-1)]: Done 56624 tasks      | elapsed:  1.7min
[Parallel(n_jobs=-1)]: Done 59400 out of 59400 | elapsed:  1.8min finished
# Samples: 50, Tasks: 59400, Jobs: -1:   0%|          | 0/5 [01:48&lt;?, ?it/s]
</code></pre></div>


<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">time</span>

<span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">df_</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results_df</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">t0</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time Taken: </span><span class="si">{</span><span class="n">t1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> secs&quot;</span><span class="p">)</span>
<span class="n">df_</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div>

<div class="codehilite"><pre><span></span><code>Time Taken: 37.71 secs
</code></pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>trial</th>
      <th>std</th>
      <th>nu</th>
      <th>samples</th>
      <th>dimensions</th>
      <th>standardize</th>
      <th>per_dimension</th>
      <th>separate_scales</th>
      <th>sigma_method</th>
      <th>sigma_percent</th>
      <th>sigma_X</th>
      <th>sigma_Y</th>
      <th>scorer</th>
      <th>score</th>
      <th>mutual_info</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>59395</th>
      <td>gauss</td>
      <td>5</td>
      <td>11</td>
      <td>1</td>
      <td>50</td>
      <td>2</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>median</td>
      <td>0.9</td>
      <td>2.88898</td>
      <td>2.88898</td>
      <td>cka</td>
      <td>0.480297</td>
      <td>0.390005</td>
    </tr>
    <tr>
      <th>59396</th>
      <td>gauss</td>
      <td>5</td>
      <td>11</td>
      <td>1</td>
      <td>50</td>
      <td>3</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>median</td>
      <td>0.9</td>
      <td>3.35418</td>
      <td>3.35418</td>
      <td>cka</td>
      <td>0.530064</td>
      <td>0.377389</td>
    </tr>
    <tr>
      <th>59397</th>
      <td>gauss</td>
      <td>5</td>
      <td>11</td>
      <td>1</td>
      <td>50</td>
      <td>10</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>median</td>
      <td>0.9</td>
      <td>5.687</td>
      <td>5.687</td>
      <td>cka</td>
      <td>0.714579</td>
      <td>0.929178</td>
    </tr>
    <tr>
      <th>59398</th>
      <td>gauss</td>
      <td>5</td>
      <td>11</td>
      <td>1</td>
      <td>50</td>
      <td>50</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>median</td>
      <td>0.9</td>
      <td>13.6425</td>
      <td>13.6425</td>
      <td>cka</td>
      <td>0.975977</td>
      <td>4.052644</td>
    </tr>
    <tr>
      <th>59399</th>
      <td>gauss</td>
      <td>5</td>
      <td>11</td>
      <td>1</td>
      <td>50</td>
      <td>100</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>median</td>
      <td>0.9</td>
      <td>19.2544</td>
      <td>19.2544</td>
      <td>cka</td>
      <td>0.987792</td>
      <td>7.938746</td>
    </tr>
  </tbody>
</table>
</div>

<p><strong>Note</strong>: This is another bottleneck.</p>
<h4 id="appending-to-file">Appending to File<a class="headerlink" href="#appending-to-file" title="Permanent link">&para;</a></h4>
<p>We can use this simple pseudocode to append to a file.</p>
<div class="highlight"><pre><span></span><code><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
<span class="n">header</span><span class="o">=</span><span class="kc">False</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">RES_PATH</span><span class="si">}{</span><span class="n">save_name</span><span class="si">}</span><span class="s2">.csv&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>
    <span class="n">header</span><span class="o">=</span><span class="kc">True</span>
</code></pre></div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../2.0_preliminary_exp/" title="1D Parameter Space" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z" /></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                1D Parameter Space
              </div>
            </div>
          </a>
        
        
          <a href="../4.0_dist_vs_mi/" title="Mutual Info vs Scores" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Mutual Info vs Scores
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z" /></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 J. Emmanuel Johnson
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
      <a href="https://github.com/jejjohnson" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
      <a href="https://twitter.com/jejjohnson" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
      <a href="https://linkedin.com/in/jejjohnson" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
      <a href="https://jejjohnson.netlify.com" target="_blank" rel="noopener" title="jejjohnson.netlify.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.f81b9e8b.min.js"></script>
      <script src="../../assets/javascripts/bundle.23546af0.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.58d22e8e.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
        <script src="../../javascripts/extra.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      
    
  </body>
</html>