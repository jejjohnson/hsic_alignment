<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>

<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
# Isotropic Scaling Experiment
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Synopsis

In this experiment, I will be looking at how the isotropic scaling effects the HSIC score for the HSIC and KA algorithms. In theory, because we are trying to find one parameter shared between the two kernel functions, there should be problems when the scale of one distribution is larger than another. It's a drawback of the method and it motivates the need to use two different parameters for the distributions.
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Code
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
import sys, os
# Insert path to model directory,.
cwd = os.getcwd()
path = f"{cwd}/../../src"
sys.path.insert(0, path)

import warnings
import tqdm
import random
import pandas as pd
import numpy as np
import argparse
from sklearn.utils import check_random_state

# toy datasets
from data.toy import generate_dependence_data, generate_isotropic_data

# Kernel Dependency measure
from models.train_models import get_gamma_init
from models.train_models import get_hsic
from models.kernel import estimate_sigma, sigma_to_gamma, gamma_to_sigma, get_param_grid
from models.ite_algorithms import run_rbig_models
from sklearn.preprocessing import StandardScaler

# Plotting
from visualization.distribution import plot_scorer
from visualization.scaling import plot_scorer_scale, plot_scorer_scale_norm


# experiment helpers
from tqdm import tqdm

# Plotting Procedures
import matplotlib
import matplotlib.pyplot as plt
import seaborn as sns
# plt.style.use(['fivethirtyeight', 'seaborn-poster'])
warnings.filterwarnings('ignore') # get rid of annoying warnings
%matplotlib inline


%load_ext autoreload
%autoreload 2
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
plt.style.available
```

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_text output_subarea output_execute_result">
<pre>[&#39;seaborn-dark-palette&#39;,
 &#39;classic&#39;,
 &#39;ggplot&#39;,
 &#39;seaborn-dark&#39;,
 &#39;seaborn-pastel&#39;,
 &#39;seaborn-bright&#39;,
 &#39;seaborn-deep&#39;,
 &#39;tableau-colorblind10&#39;,
 &#39;seaborn-talk&#39;,
 &#39;fast&#39;,
 &#39;seaborn-ticks&#39;,
 &#39;seaborn-white&#39;,
 &#39;bmh&#39;,
 &#39;fivethirtyeight&#39;,
 &#39;seaborn-muted&#39;,
 &#39;_classic_test&#39;,
 &#39;grayscale&#39;,
 &#39;seaborn-darkgrid&#39;,
 &#39;seaborn-poster&#39;,
 &#39;seaborn&#39;,
 &#39;seaborn-whitegrid&#39;,
 &#39;dark_background&#39;,
 &#39;seaborn-paper&#39;,
 &#39;seaborn-colorblind&#39;,
 &#39;seaborn-notebook&#39;,
 &#39;Solarize_Light2&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
### Experimental Design
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
The objective of this experiment is to measure how the Mutual information (MI) changes related to the HSIC score of different methods when we change the data and preprocessing conditions (normalization and scale). We change the nature of the data via the scale of the data received and whether or not we do a normalization procedure before we submit the datasets to our HSIC algorithms. Each HSIC method will give us a score and we can calculate the Mutual information

**Free Params**

* Number of Trials (`seed`)
    * 1:10
* Scale or not scaled (`scale`)
* Normalized | Not Normalized (`normalize`)
* HSIC Algorithm (`method`)
    * HSIC, KA, cKA
* Dataset (`dataset`)
    * Linear, Sinusoidal, Circle, Random
* Amount of Noise (`noise` List)
    * log space 

**Measurements**

* Mutual Information (`mi`)
* HSIC score (`score`)
* Time for execution (`time`)

**Fixed Parameters**

* Number of points (`num_points`)
* Noise for X points (`noise_x`)
* Noise for Y points (`noise_y`)
* 
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Demo
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
class DataParams:
    num_points = 1_000
    noise_y = 0.1
    alpha = 1.0
    beta = 1.0

class ExpParams:
    dataset = ['line', 'sine', 'circ', 'rand']
    seed = np.linspace(1,10,10)
    scale = np.logspace(-2, 2, 10)
    normalized = [True, False]
    noise = np.logspace(-3, 1, 10)
    method = ['hsic', 'tka', 'ctka']
    each_length = [False, True]
    gamma_method = [
        ('median', 0.2, None),
        ('median', 0.4, None),
        ('median', 0.5, None),
        ('median', 0.6, None),
        ('median', 0.8, None),
    ]
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
from scipy.special import digamma
from sklearn.neighbors import NearestNeighbors
from typing import Optional

def compute_knn_mi(x: np.ndarray, y: np.ndarray, n_neighbors: Optional[int]=5)-> float:
    """Compute mutual information between two continuous variables.
    Parameters
    ----------
    x, y : ndarray, shape (n_samples,)
        Samples of two continuous random variables, must have an identical
        shape.
    n_neighbors : int
        Number of nearest neighbors to search for each point, see [1]_.
    Returns
    -------
    mi : float
        Estimated mutual information. If it turned out to be negative it is
        replace by 0.
    Notes
    -----
    True mutual information can't be negative. If its estimate by a numerical
    method is negative, it means (providing the method is adequate) that the
    mutual information is close to 0 and replacing it by 0 is a reasonable
    strategy.
    References
    ----------
    .. [1] A. Kraskov, H. Stogbauer and P. Grassberger, "Estimating mutual
           information". Phys. Rev. E 69, 2004.
    """
    n_samples = x.size

    x = x.reshape((-1, 1))
    y = y.reshape((-1, 1))
    xy = np.hstack((x, y))

    # Here we rely on NearestNeighbors to select the fastest algorithm.
    nn = NearestNeighbors(metric='euclidean', n_neighbors=n_neighbors)

    nn.fit(xy)
    radius = nn.kneighbors()[0]
    radius = np.nextafter(radius[:, -1], 0)

    # Algorithm is selected explicitly to allow passing an array as radius
    # later (not all algorithms support this).
    nn.set_params(algorithm='kd_tree')

    nn.fit(x)
    ind = nn.radius_neighbors(radius=radius, return_distance=False)
    nx = np.array([i.size for i in ind])

    nn.fit(y)
    ind = nn.radius_neighbors(radius=radius, return_distance=False)
    ny = np.array([i.size for i in ind])

    mi = (digamma(n_samples) + digamma(n_neighbors) -
          np.mean(digamma(nx + 1)) - np.mean(digamma(ny + 1)))

    return max(0.0, mi)
```

</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
#### Helper Functions
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
from typing import Tuple, Type, Optional

def get_gamma_name(gamma_method: Tuple[str,str,str])-> str:
    if gamma_method[1] is None and gamma_method[2] is None:
        gamma_name = gamma_method[0]
    elif gamma_method[1] is not None and gamma_method[2] is None:
        gamma_name = f"{gamma_method[0]}_p{gamma_method[1]}"
    elif gamma_method[1] is None and gamma_method[2] is not None:
        gamma_name = f"{gamma_method[0]}_s{gamma_method[2]}"
    elif gamma_method[1] is not None and gamma_method[2] is not None:
        gamma_name = f"{gamma_method[0]}_s{gamma_method[1]}_s{gamma_method[2]}"
    else:
        raise ValueError('Unrecognized Combination...')
    return gamma_name

def plot_data(X: np.ndarray, Y: np.ndarray):
    fig, ax = plt.subplots(nrows=1, figsize=(7, 5))

    ax.scatter(X, Y, color='red')
    # plt.legend(fontsize=20)
    plt.xticks(fontsize=20)
    plt.yticks(fontsize=20)
    plt.tight_layout()
    plt.show()
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
PROJECT_PATH = "/home/emmanuel/projects/2019_hsic_align/"
LOG_PATH = "src/experiments/logs/"
SAVE_PATH = "data/results/scaling/"
SAVE_NAME = 'exp_scale_test.csv'


class ScaleExperiment:
    def __init__(self, data_params, exp_params):
        self.data_params = data_params
        self.exp_params = exp_params
        
    def _get_data(self, dataset: str, noise: float, seed: int)-> Tuple[np.ndarray, np.ndarray]:
        """Gathers the raw dependence data"""
        # get dataset
        X, Y = generate_dependence_data(
            dataset=dataset,
            num_points=10_000, #self.data_params.num_points,
            seed=seed,
            noise_x=noise,
            noise_y=noise,
            alpha=self.data_params.alpha,
            beta=self.data_params.beta
        )
        return X, Y
    
    def _apply_noise(self, X: np.ndarray, Y: np.ndarray, noise: float, seed: int)-> Tuple[np.ndarray, np.ndarray]:
        
        rng = check_random_state(seed)
        
        X += rng.randn(X.shape[0], X.shape[1])
#         Y += rng.randn(Y.shape)
        
        
        return X, Y
    def _apply_scaling(self, X: np.ndarray, scale: float)-> np.ndarray:
        """The scaling step in our experiment"""
        # apply scaling
        return scale * X
    
    def _apply_normalization(self, X: np.ndarray, Y: np.ndarray, normalize: bool)-> np.ndarray:
        """The normalization step in our experiment."""
        # apply normalization
        if normalize == True:
            X = StandardScaler().fit_transform(X)
            Y = StandardScaler().fit_transform(Y)
        elif normalize == False:
            pass
        else:
            raise ValueError(f'Unrecognized boolean value for normalize {normalize}')
        return X, Y
    
    def _apply_mi_estimate(self, X: np.ndarray, Y: np.ndarray)-> float:
        """Apply Mutual Information estimator. 
        We choose to use RBIG as our estimator."""
        # estimate mutual information
#         mi = compute_knn_mi(X, Y, 15)
        mi, _ = run_rbig_models(X, Y, measure='mi', verbose=None)
        
        return mi
    
    def _apply_hsic_estimate(
        self, 
        X: np.ndarray, 
        Y: np.ndarray, 
        method: str, 
        gamma_init: Tuple[str, Optional[float], Optional[float]],
        each_length: bool=False)-> float:
        """Apply HSIC estimator using one of the 3 algorithms:
        * HSIC
        * KA
        * cKA
        """
        # initialize the gamma parameter
        if each_length == True:
            gamma_init_X, gamma_init_Y = get_gamma_init(
                X, Y, 
                method=gamma_init[0], 
                percent=gamma_init[1], 
                scale=gamma_init[2], 
                each_length=True)
        
            # get hsic_value
            hsic_value = get_hsic(
                X=X, Y=Y, 
                scorer=method, 
                gamma_init_X=gamma_init_X, 
                gamma_init_Y=gamma_init_Y,
                maximum=False)
        elif each_length == False:
            gamma_init = get_gamma_init(                
                X, Y, 
                method=gamma_init[0], 
                percent=gamma_init[1], 
                scale=gamma_init[2], 
                each_length=False)
        
            # get hsic_value
            hsic_value = get_hsic(X, Y, method, gamma_init, maximum=False, subsample=self.data_params.num_points)
        else:
            raise ValueError(f'Unrecognized selection for each_length: {each_length}')
        
        return hsic_value
    
    def _experiment_step(
        self,
        results_df: pd.DataFrame,
        dataset: str,
        noise: float, seed: int,
        scale: float,
        normalize: bool,
        method: str,
        gamma_init: Tuple[str, Optional[float], Optional[float]],
        each_length: bool=False,
    )-> pd.DataFrame:
        
        # Step I - Extract Data
        X, Y = self._get_data(dataset=dataset, noise=noise, seed=seed)
        
#         # Step I.1 - Apply Noise
#         X, Y = self._apply_noise(X=X, Y=Y, noise=noise, seed=seed)
        
        # Step II - Apply Scaling
        X = self._apply_scaling(X=X, scale=scale)

        # Step III - Apply Normalization
        X, Y = self._apply_normalization(X=X, Y=Y, normalize=normalize)

        # Step IV - Estimate mutual information
        mi = self._apply_mi_estimate(X, Y)

        # Step IV - Estimate HSIC value
        hsic_value = self._apply_hsic_estimate(
            X, Y, 
            method=method, 
            gamma_init=gamma_init, 
            each_length=each_length
        )
        
        # Step V - Save Results to dataframe
        results_df = results_df.append({
            'normalized': normalize,
            'trial': seed,
            'dataset': dataset,
            'scale': scale,
            'scorer': method,
            'gamma_method': get_gamma_name(gamma_init),
            'hsic_value': hsic_value,
            "mi": mi,
            "noise": noise,
            "each": each_length,
        }, ignore_index=True)
        return results_df
    
    def run_experiment(self):
        
        
        results_df = pd.DataFrame()
#         print(self.exp_params.seed)
        
        # Loop Through Free Parameters
        for iseed in self.exp_params.seed:
#             print(iseed)
            for idataset in self.exp_params.dataset:
                for inoise in self.exp_params.noise: 
                    for iscale in self.exp_params.scale:
                        for inormalize in self.exp_params.normalized:
                            for ilength in self.exp_params.each_length:
                                for igamma in self.exp_params.gamma_method:
                                    for imethod in self.exp_params.method:
                                        results_df = self._experiment_step(
                                            results_df=results_df,
                                            dataset=idataset,
                                            noise=inoise, 
                                            seed=iseed,
                                            scale=iscale,
                                            normalize=inormalize,
                                            method=imethod,
                                            gamma_init=igamma,
                                            each_length=ilength
                                        )
                                    results_df.to_csv(
                                        PROJECT_PATH
                                        + SAVE_PATH
                                        + f"{SAVE_NAME}"
                                    )
        return results_df
            
```

</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
#### Test Run - Full Algorithm
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# Initialize Experiment class
exp_class = ScaleExperiment(DataParams, ExpParams, )

# ========================================
# Step I - Extract data
# ========================================
dataset = 'sine'
noise = 0.01
seed = 123

X, Y = exp_class._get_data(dataset=dataset, noise=noise, seed=seed)

plot_data(X,Y)

# ========================================
# Step IV - Estimate mutual information
# ========================================
mi = exp_class._apply_mi_estimate(X, Y)

print(f'MI (RBIG): {mi:.4f}')

# ========================================
# Step II - Apply Scaling
# ========================================
scale = 10.

X = exp_class._apply_scaling(X=X, scale=scale)
plot_data(X,Y)

# ========================================
# Step III - Apply Normalization
# ========================================
normalize = True

X, Y = exp_class._apply_normalization(X=X, Y=Y, normalize=normalize)

plot_data(X,Y)



# ========================================
# Step V - Estimate HSIC value
# ========================================
method = 'hsic'
gamma_init = ('median', 0.5, None)
each_length = True

hsic_value = exp_class._apply_hsic_estimate(
    X, Y, 
    method=method, 
    gamma_init=gamma_init, 
    each_length=each_length
)

print(f'HSIC score ({method}): {hsic_value:.4f}')
```

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">


<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
#### Test Run - Experimental Step
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
class DataParams:
    num_points = 5_000
    noise_y = 0.1
    alpha = 1.0
    beta = 1.0

class ExpParams:
    dataset = [
        'line', 
        'sine', 
#         'circ',
#         'rand'
    ]
    seed = [1] #np.linspace(1,10,10)
    scale = np.logspace(-2, 2, 10)
    normalized = [
        True, 
        False
    ]
    noise = np.logspace(-3, 1, 10)
    method = [
        'hsic', 
        'tka', 
        'ctka'
    ]
    each_length = [
#         False, 
        True
    ]
    gamma_method = [
#         ('median', 0.2, None),
#         ('median', 0.4, None),
        ('median', 0.5, None),
#         ('median', 0.6, None),
#         ('median', 0.8, None),
    ]
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# Initialize Experiment class
exp_class = ScaleExperiment(DataParams, ExpParams, )

results_df = pd.DataFrame()
results_df = exp_class._experiment_step(
    results_df=results_df,
    dataset=dataset, noise=noise, seed=seed,
    scale=scale,
    normalize=normalize,
    method=method,
    gamma_init=gamma_init
)
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
results_df.head()
```

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>each</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>sine</td>
      <td>0.0</td>
      <td>median_p0.5</td>
      <td>0.091784</td>
      <td>3.355914</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>10.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
#### Test Run - Full Experiment Loop
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
class DataParams:
    num_points = 1_000
    noise_y = 0.1
    alpha = 1.0
    beta = 1.0

class ExpParams:
    dataset = [
        'line', 
        'sine', 
#         'circ',
#         'rand'
    ]
    seed = [1] #np.linspace(1,10,10)
    scale = np.logspace(-2, 2, 10)
    normalized = [
        True, 
        False
    ]
    noise = np.logspace(-3, 1, 10)
    method = [
        'hsic', 
        'tka', 
        'ctka'
    ]
    each_length = [False, True]
    gamma_method = [
#         ('median', 0.2, None),
#         ('median', 0.4, None),
        ('median', 0.5, None),
#         ('median', 0.6, None),
#         ('median', 0.8, None),
    ]

# Initialize Experiment class
exp_class = ScaleExperiment(DataParams, ExpParams, )

results_df = exp_class.run_experiment()
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
results_df.tail()
```

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>each</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2395</th>
      <td>sine</td>
      <td>0.0</td>
      <td>median_p0.5</td>
      <td>0.194763</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2396</th>
      <td>sine</td>
      <td>0.0</td>
      <td>median_p0.5</td>
      <td>0.008053</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2397</th>
      <td>sine</td>
      <td>1.0</td>
      <td>median_p0.5</td>
      <td>0.000585</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2398</th>
      <td>sine</td>
      <td>1.0</td>
      <td>median_p0.5</td>
      <td>0.673256</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2399</th>
      <td>sine</td>
      <td>1.0</td>
      <td>median_p0.5</td>
      <td>0.006027</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>0.0</td>
      <td>100.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python

```

</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
## Cases - Walkthrough
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
def get_params(case: int):

    # Case I - Unscaled, Unnormalized
    if case == 1:

        class DataParams:
            num_points = 2_000
            noise_y = 0.0
            alpha = 1.0
            beta = 1.0

        class ExpParams:
            dataset = [
                "line",
                "sine",
                "circ",
                # "rand"
            ]
            seed = np.linspace(1, 10, 10, dtype=int)
            scale = [1.0]
            normalized = [False]
            noise = np.logspace(-2, 1, 10)
            method = ["hsic", "tka", "ctka"]
            gamma_method = [
                ("median", 0.2, None),
                ("median", 0.4, None),
                ("median", 0.5, None),
                ("median", 0.6, None),
                ("median", 0.8, None),
            ]

    # Case II - Unscaled, Normalized
    elif case == 2:

        class DataParams:
            num_points = 2_000
            noise_y = 0.0
            alpha = 1.0
            beta = 1.0

        class ExpParams:
            dataset = [
                "line",
                "sine",
                "circ",
                # "rand"
            ]
            seed = np.linspace(1, 10, 10, dtype=int)
            scale = [1.0]
            normalized = [True]
            noise = np.logspace(-2, 1, 10)
            method = ["hsic", "tka", "ctka"]
            gamma_method = [
                ("median", 0.2, None),
                ("median", 0.4, None),
                ("median", 0.5, None),
                ("median", 0.6, None),
                ("median", 0.8, None),
            ]

    # Case III - Scaled, Unnormalized
    elif case == 3:

        class DataParams:
            num_points = 2_000
            noise_y = 0.01
            alpha = 1.0
            beta = 1.0

        class ExpParams:
            dataset = [
                "line",
                "sine",
                "circ",
                # "rand",
            ]
            seed = np.linspace(1, 10, 10, dtype=int)
            scale = np.logspace(-2, 2, 10)
            normalized = [False]
            noise = np.logspace(-2, 1, 10)
            method = ["hsic", "tka", "ctka"]
            gamma_method = [
                ("median", 0.2, None),
                ("median", 0.4, None),
                ("median", 0.5, None),
                ("median", 0.6, None),
                ("median", 0.8, None),
            ]

    elif case == 4:

        class DataParams:
            dataset = "line"
            num_points = 2_000
            noise_y = 0.01
            alpha = 1.0
            beta = 1.0

        class ExpParams:
            dataset = [
                "line",
                "sine",
                "circ",
                # "rand"
            ]
            seed = np.linspace(1, 10, 10, dtype=int)
            scale = np.logspace(-2, 2, 10)  # [0.01, 1.0, 100.0]
            normalized = [True]
            noise = np.logspace(-3, 1, 10)
            method = ["hsic", "tka", "ctka"]
            gamma_method = [
                ("median", 0.2, None),
                ("median", 0.4, None),
                ("median", 0.5, None),
                ("median", 0.6, None),
                ("median", 0.8, None),
            ]

    else:
        raise ValueError(f"Unrecognized case: '{case}'")

    return DataParams, ExpParams
```

</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
#### Case I - Unscaled, Unnormalized
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
For this first walkthrough, we are assuming that the data is unscaled and that the data is unnormalized. 

**Hypothesis**: We all methods should showcase some relationship to the amount of Mutual information but it will not necessarily be a strict relationship. Thinking from the previous results, the KA method should perform the worst, the HSIC method should perform OK with some inconsistencies and the CKA should perform the best and showcase a trend.
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# case number
case = 1

# get parameters
DataParams, ExpParams = get_params(case=case)

# Initialize Experiment class
exp_class = ScaleExperiment(DataParams, ExpParams, )

results_df = exp_class.run_experiment()
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
results_df
```

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110588</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.105917</td>
      <td>3.074389</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999368</td>
      <td>3.074389</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998062</td>
      <td>3.074389</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110391</td>
      <td>3.111298</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999400</td>
      <td>3.111298</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998244</td>
      <td>3.111298</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
#### Case II - Unscaled, Normalized
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
In this case, we see that
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# case number
case = 2

# get parameters
DataParams, ExpParams = get_params(case=case)

# Initialize Experiment class
exp_class = ScaleExperiment(DataParams, ExpParams, )

# Run experiment
results_df = exp_class.run_experiment()
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
results_df
```

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110589</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.089667</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.946835</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.843181</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.003926</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.686470</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.040370</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
#### Case III - Scaled, Unormalized
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# case number
case = 3

# get parameters
DataParams, ExpParams = get_params(case=case)

# Initialize Experiment class
exp_class = ScaleExperiment(DataParams, ExpParams, )

# Run Experiment
results_df = exp_class.run_experiment()
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
results_df
```

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>1.109297e-04</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.316801e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.369142e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>1.105885e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>9.993656e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>9.981718e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>1.099729e-04</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.323451e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.371835e-01</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>8.439792e-05</td>
      <td>0.963049</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.369820e-01</td>
      <td>0.963049</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>5.583300e-01</td>
      <td>0.963049</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>8.954440e-02</td>
      <td>1.043494</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>9.467536e-01</td>
      <td>1.043494</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>8.424410e-01</td>
      <td>1.043494</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>1.074575e-04</td>
      <td>1.005067</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.325034e-01</td>
      <td>1.005067</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>5.704429e-01</td>
      <td>1.005067</td>
      <td>0.10</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>4.451921e-07</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.299457e-01</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>3.129644e-02</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>2.026650e-03</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.870766e-01</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>3.598772e-02</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>8.407697e-05</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>6.384854e-01</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>4.028872e-02</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>0.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered" markdown="1">
<div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
#### Case IV - Scaled, Normalized
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
# case number
case = 4

# get parameters
DataParams, ExpParams = get_params(case=case)

# Initialize Experiment class
exp_class = ScaleExperiment(DataParams, ExpParams, )

# Run Experiment
results_df = exp_class.run_experiment()
```

</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python
results_df
```

</div>

<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">


<div class="output_area" markdown="1">

<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>dataset</th>
      <th>gamma_method</th>
      <th>hsic_value</th>
      <th>mi</th>
      <th>noise</th>
      <th>normalized</th>
      <th>scale</th>
      <th>scorer</th>
      <th>trial</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110589</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110589</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.110589</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.999366</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.998172</td>
      <td>3.094753</td>
      <td>0.01</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.089667</td>
      <td>1.036774</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.946835</td>
      <td>1.036774</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.843181</td>
      <td>1.036774</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.089667</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.946835</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.843181</td>
      <td>1.011999</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.089667</td>
      <td>1.036760</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.946835</td>
      <td>1.036760</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.843181</td>
      <td>1.036760</td>
      <td>0.10</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.003926</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.686470</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.040370</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>0.01</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.003926</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.686470</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.040370</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>1.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.003926</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>hsic</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.686470</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>tka</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>line</td>
      <td>median_p0.5</td>
      <td>0.040370</td>
      <td>0.043903</td>
      <td>1.00</td>
      <td>1.0</td>
      <td>100.00</td>
      <td>ctka</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered" markdown="1">
<div class="input">

```python

```

</div>

</div>


